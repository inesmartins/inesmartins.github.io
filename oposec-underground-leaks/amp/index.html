<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>ØxOPOSɆC | Underground Leaks (Crypto)</title>

    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:type" content="article" />
    <meta property="og:title" content="ØxOPOSɆC | Underground Leaks (Crypto)" />
    <meta property="og:description" content="Write-up for retired Oposec&#x27;s October challenge" />
    <meta property="og:url" content="inesmartins.github.io/oposec-underground-leaks/" />
    <meta property="og:image" content="inesmartins.github.io/content/images/2020/10/highres_471963990-1-1.jpeg" />
    <meta property="article:published_time" content="2020-10-27T22:02:35.000Z" />
    <meta property="article:modified_time" content="2021-02-27T19:10:22.000Z" />
    <meta property="article:tag" content="crypto" />
    <meta property="article:tag" content="java" />
    <meta property="article:tag" content="ctf" />
    <meta property="article:tag" content="oposec" />
    <meta property="article:tag" content="random" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ØxOPOSɆC | Underground Leaks (Crypto)" />
    <meta name="twitter:description" content="Write-up for retired Oposec&#x27;s October challenge" />
    <meta name="twitter:url" content="inesmartins.github.io/oposec-underground-leaks/" />
    <meta name="twitter:image" content="inesmartins.github.io/content/images/2020/10/highres_471963990-1-1.jpeg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Inês Martins" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="crypto, java, ctf, oposec, random" />
    <meta property="og:image:width" content="504" />
    <meta property="og:image:height" content="105" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "",
        "url": "inesmartins.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "inesmartins.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Inês Martins",
        "url": "inesmartins.github.io/author/ines/",
        "sameAs": []
    },
    "headline": "ØxOPOSɆC | Underground Leaks (Crypto)",
    "url": "inesmartins.github.io/oposec-underground-leaks/",
    "datePublished": "2020-10-27T22:02:35.000Z",
    "dateModified": "2021-02-27T19:10:22.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "inesmartins.github.io/content/images/2020/10/highres_471963990-1-1.jpeg",
        "width": 504,
        "height": 105
    },
    "keywords": "crypto, java, ctf, oposec, random",
    "description": "Write-up for retired Oposec&#x27;s October challenge",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "inesmartins.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.7" />
    <link rel="alternate" type="application/rss+xml" title="" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: var(--ghost-accent-color, #1292EE);
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: var(--ghost-accent-color, #1292EE);
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #15171a;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }

    :root {--ghost-accent-color: #000000;}
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">ØxOPOSɆC | Underground Leaks (Crypto)</h1>
                <section class="post-meta">
                    Inês Martins -
                    <time class="post-date" datetime="2020-10-27">27 Oct 2020</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="inesmartins.github.io/content/images/2020/10/highres_471963990-1-1.jpeg" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <pre><code>Rui Tinto admitted having some information about the snitch from the 0XOPOLEAKS. However, he's unwilling to give the passwords unless his demands of having Kripthor on 0xOPOSEC get fulfilled. 
Meanwhile, government forces tried to crack the passwords with no success. 
We know from underground sources that Rui Tinto does cipher each file individually for higher security and privacy. 
We manage to put our hands on his top-notch closed source software used for encrypting the information.
Leak: https://sefod.eu/oposec/underground_leaks.tar.gz</code></pre><p>The tar contains a java executable and 3 files that look like ciphertexts:</p><pre><code>~ ls -la ./
...
-rw-r--r--   1 inesmartins  staff    32 Oct 16 11:09 1
-rw-r--r--   1 inesmartins  staff    32 Oct 16 11:09 2
-rw-r--r--   1 inesmartins  staff    32 Oct 16 11:09 3
-rw-r--r--   1 inesmartins  staff  3992 Oct 16 10:38 HelloWorldApp.class</code></pre><pre><code>~ xxd 1
00000000: ad42 207a 20db eb81 b536 25a0 865e 6778  .B z ....6%..^gx
00000010: f23d 2a26 8e76 9970 6cfd 0673 2051 002b  .=*&amp;.v.pl..s Q.+

~ xxd 2
00000000: 2dcd cdcd a751 4e47 fd46 e8e0 8334 eade  -....QNG.F...4..
00000010: 1796 e6e4 b25f 6f8d 5d47 f2b6 f688 38f7  ....._o.]G....8.

~ xxd 3
00000000: dada da4d 43e1 9595 3914 ca23 d84a df52  ...MC...9..#.J.R
00000010: d897 0b06 89e7 773e 7f31 7dca 4a52 e2b7  ......w&gt;.1}.JR..</code></pre><p>It seems like this application encrypts a secret in a file that we provide:</p><pre><code>~ touch plaintext.txt
~ java HelloWorldApp encode plaintext.txt
Hey kid, do you have any leaks?
tell me:
this is my very secret secret
Keep this key: E5F1F22FE01B9E10D17E3825ACE23799</code></pre><p>Once we have they key, we're then able to get the secret back using the same application:</p><pre><code>~ java HelloWorldApp decode plaintext.txt
Please provide a key:
E5F1F22FE01B9E10D17E3825ACE23799
this is my very secret secret</code></pre><hr></hr><h2 id="analysing-the-application">Analysing the application</h2><p>I started by decompiling the file using <a href="https://marketplace.visualstudio.com/publishers/tintinweb">tintinweb</a>:</p><pre><code class="language-java">import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStreamReader;
import java.util.Random;
import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

class HelloWorldApp {
  static String encryption_mode = "AES/CBC/PKCS5Padding";
  
  public static void main(String[] paramArrayOfString) {
    if (paramArrayOfString.length == 2) {
      if (paramArrayOfString[0].equals("decode")) {
        decode(paramArrayOfString[1]);
      } else if (paramArrayOfString[0].equals("encode")) {
        encode(paramArrayOfString[1]);
      } else {
        System.out.print("encode|decode file_input|file_output");
        System.exit(0);
      } 
    } else {
      System.out.print("encode|decode file_input|file_output");
      System.exit(0);
    } 
  }
  
  public static void encode(String paramString) {
    Random random = new Random(5040508L);
    int i = (new Random()).nextInt(1000000);
    for (b = 0; b &lt; i; b++)
      random.nextInt(256); 
    try {
      String str1 = "read text from input";
      BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));
      System.out.print("Hey kid, do you have any leaks?\ntell me:\n");
      String str2 = bufferedReader.readLine();
      str1 = "creating iv key";
      byte[] arrayOfByte1 = new byte[16];
      for (byte b1 = 0; b1 &lt; 16; b1++) {
        int j = random.nextInt(256);
        arrayOfByte1[b1] = (byte)j;
      } 
      str1 = "creating key";
      byte[] arrayOfByte2 = new byte[16];
      for (byte b2 = 0; b2 &lt; 16; b2++) {
        int j = random.nextInt(256);
        arrayOfByte2[b2] = (byte)j;
      } 
      str1 = "encrypting content";
      byte[] arrayOfByte3 = encrypt(str2, arrayOfByte2, arrayOfByte1);
      str1 = "write content to file";
      FileOutputStream fileOutputStream = new FileOutputStream(paramString);
      fileOutputStream.write(arrayOfByte1);
      fileOutputStream.write(arrayOfByte3);
      fileOutputStream.close();
      System.out.print("Keep this key: ");
      System.out.print(bytesToHex(arrayOfByte2));
    } catch (Exception b) {
      Exception exception;
      exception.printStackTrace();
    } 
  }
  
  public static void decode(String paramString) {
    String str = "read file, split iv and encrypted content and decode with the input key";
    try {
      File file = new File(paramString);
      FileInputStream fileInputStream = new FileInputStream(file);
      byte[] arrayOfByte1 = fileInputStream.readAllBytes();
      byte[] arrayOfByte2 = new byte[16];
      for (byte b = 0; b &lt; arrayOfByte2.length; b++)
        arrayOfByte2[b] = arrayOfByte1[b]; 
      System.out.print("Please provide a key:\n");
      BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(System.in));
      String str1 = bufferedReader.readLine();
      byte[] arrayOfByte3 = hexStringToByteArray(str1);
      byte[] arrayOfByte4 = new byte[arrayOfByte1.length - arrayOfByte2.length];
      for (int i = arrayOfByte2.length; i &lt; arrayOfByte1.length; i++)
        arrayOfByte4[i - arrayOfByte2.length] = arrayOfByte1[i]; 
      String str2 = decrypt(arrayOfByte4, arrayOfByte3, arrayOfByte2);
      System.out.print(str2);
      System.out.print("\n");
    } catch (Exception exception) {
      exception.printStackTrace();
    } 
  }
  
  public static void noNeedToLookBelowThis() {}
  
  private static final char[] HEX_ARRAY = "0123456789ABCDEF".toCharArray();
  
  public static String bytesToHex(byte[] paramArrayOfByte) {
    char[] arrayOfChar = new char[paramArrayOfByte.length * 2];
    for (byte b = 0; b &lt; paramArrayOfByte.length; b++) {
      byte b1 = paramArrayOfByte[b] &amp; 0xFF;
      arrayOfChar[b * 2] = HEX_ARRAY[b1 &gt;&gt;&gt; 4];
      arrayOfChar[b * 2 + 1] = HEX_ARRAY[b1 &amp; 0xF];
    } 
    return new String(arrayOfChar);
  }
  
  public static byte[] hexStringToByteArray(String paramString) {
    int i = paramString.length();
    byte[] arrayOfByte = new byte[i / 2];
    for (byte b = 0; b &lt; i; b += 2)
      arrayOfByte[b / 2] = 
        (byte)((Character.digit(paramString.charAt(b), 16) &lt;&lt; 4) + Character.digit(paramString.charAt(b + 1), 16)); 
    return arrayOfByte;
  }
  
  public static byte[] encrypt(String paramString, byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) throws Exception {
    Cipher cipher = Cipher.getInstance(encryption_mode);
    SecretKeySpec secretKeySpec = new SecretKeySpec(paramArrayOfByte1, "AES");
    cipher.init(1, secretKeySpec, new IvParameterSpec(paramArrayOfByte2));
    return cipher.doFinal(paramString.getBytes());
  }
  
  public static String decrypt(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2, byte[] paramArrayOfByte3) throws Exception {
    Cipher cipher = Cipher.getInstance(encryption_mode);
    SecretKeySpec secretKeySpec = new SecretKeySpec(paramArrayOfByte2, "AES");
    cipher.init(2, secretKeySpec, new IvParameterSpec(paramArrayOfByte3));
    return new String(cipher.doFinal(paramArrayOfByte1));
  }
}
</code></pre><p>The first thing that stood out was the <code>AES/CBC/PKCS5Padding</code> encryption mode, which is vulnerable to  <a href="https://en.wikipedia.org/wiki/Padding_oracle_attack">Padding oracle attacks</a>. However, after trying and failing to follow this route, I took a closer look at to the logic behind the random number generation:</p><pre><code class="language-java">public static void encode(String paramString) {
    ...
    Random random = new Random(5040508L);
    int i = (new Random()).nextInt(1000000);
    for (int b = 0; b &lt; i; b++) {
    	random.nextInt(256);
    }
    ...
    try {
    
    	byte[] iv = new byte[16];
    	for (byte b1 = 0; b1 &lt; 16; b1++) {
            int j = random.nextInt(256);
            iv[b1] = (byte)j;
    	}
        
        byte[] aeskey = new byte[16];
    	for (byte b2 = 0; b2 &lt; 16; b2++) {
            int j = random.nextInt(256);
            aeskey[b2] = (byte)j;
    	}
        ...
    }
}</code></pre><p>It seems like:</p><ul><li>the random numbers are being generated using a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Random.html">Random</a> object (a Java pseudo-number generator), which is being initialised with a fixed seed: <code>5040508L</code>;</li><li>the AES key is being generated right after the IV.</li></ul><p>So, it's just a matter of brute-forcing the solution:</p><pre><code class="language-java">import java.util.Random;

public class RandomBreaker {
    
    public static String iv = "bbbbbbded5a15b60b0d7fdfe922e53a5";
    
    public static void main(String[] args) {
        byte[] ivData = hexStringToByteArray(iv);
        Random random = new Random(5040508L);
        for (int i = 0; i &lt; 1000000; i++) {
            if (matchesNext16(random, ivData)) {
                String keyHex = byteArrayToHexString(getNext16Bytes(random));
                System.out.println(keyHex);
                return;
            }
        }
    }
    
    private static boolean matchesNext16(Random random, byte[] bytes) {
        for (int i = 0; i &lt; bytes.length; i++) {
            byte nextByte = (byte)random.nextInt(256);
            if (nextByte != bytes[i]) {
                return false;
            }
        }
        return true;
    }
    
    private static byte[] getNext16Bytes(Random random) {
        byte[] bytes = new byte[16];
        for (int i = 0; i &lt; 16; i++) {
            bytes[i] = (byte)random.nextInt(256);
        }
        return bytes;
    }
    
    private static String byteArrayToHexString(byte[] a) {
        StringBuilder sb = new StringBuilder(a.length * 2);
        for(byte b: a)
            sb.append(String.format("%02x", b));
        return sb.toString();
    }
    
    private static byte[] hexStringToByteArray(String s) {
        int len = s.length();
        byte[] data = new byte[len / 2];
        for (int i = 0; i &lt; len; i += 2) {
            data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) &lt;&lt; 4) + Character.digit(s.charAt(i+1), 16));
        }
        return data;
    }
    
}</code></pre><p>After repeating this process for all the 3 files, we get the flag: <code>flag{The_truth_is_out_there}</code>.</p><p>You can find the repository with the original challenge and the other solutions <a href="https://github.com/zezadas/0xOPOSEC_0x0D_PSEUDO_RANDOM">here</a>.</p>

            </section>

        </article>
    </main>
    <footer class="page-footer">
        <h3></h3>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
