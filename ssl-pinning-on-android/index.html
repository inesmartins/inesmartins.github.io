<!DOCTYPE html>
<html lang="en">
<head>

    <title>SSL Pinning on Android</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css%3Fv=9f31058e11.css" />

    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="Inês Martins" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="SSL Pinning on Android" />
    <meta property="og:description" content="Banner source: https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter&#x3D;1 When an Android application wants to establish a secure connection with a remote host, it checks whether the certificate&#x27;s &quot;chain of trust&quot; is valid and compatible with the root CAs (Certificate Authorities) that are pre-installed in the device. However, there&#x27;s nothing" />
    <meta property="og:url" content="inesmartins.github.io/ssl-pinning-on-android/" />
    <meta property="og:image" content="inesmartins.github.io/content/images/2020/06/mitm.png" />
    <meta property="article:published_time" content="2020-06-08T12:26:32.000Z" />
    <meta property="article:modified_time" content="2020-11-23T18:02:43.000Z" />
    <meta property="article:tag" content="ssl" />
    <meta property="article:tag" content="android" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="SSL Pinning on Android" />
    <meta name="twitter:description" content="Banner source: https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter&#x3D;1 When an Android application wants to establish a secure connection with a remote host, it checks whether the certificate&#x27;s &quot;chain of trust&quot; is valid and compatible with the root CAs (Certificate Authorities) that are pre-installed in the device. However, there&#x27;s nothing" />
    <meta name="twitter:url" content="inesmartins.github.io/ssl-pinning-on-android/" />
    <meta name="twitter:image" content="inesmartins.github.io/content/images/2020/06/mitm.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Inês Martins" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="ssl, android" />
    <meta property="og:image:width" content="847" />
    <meta property="og:image:height" content="382" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Inês Martins",
        "url": "inesmartins.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "inesmartins.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Inês Martins",
        "image": {
            "@type": "ImageObject",
            "url": "inesmartins.github.io/content/images/2021/07/750px-Black_flag.svg.png",
            "width": 750,
            "height": 450
        },
        "url": "inesmartins.github.io/author/ines/",
        "sameAs": [
            "https://gist.github.com/inesmartins/"
        ]
    },
    "headline": "SSL Pinning on Android",
    "url": "inesmartins.github.io/ssl-pinning-on-android/",
    "datePublished": "2020-06-08T12:26:32.000Z",
    "dateModified": "2020-11-23T18:02:43.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "inesmartins.github.io/content/images/2020/06/mitm.png",
        "width": 847,
        "height": 382
    },
    "keywords": "ssl, android",
    "description": "Banner source: \nhttps://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter&#x3D;1\n\nWhen an Android application wants to establish a secure connection with a remote\nhost, it checks whether the certificate&#x27;s &quot;chain of trust&quot; is valid and\ncompatible with the root CAs (Certificate Authorities) that are pre-installed in\nthe device.\n\nHowever, there&#x27;s nothing stopping malicious actors from generating valid\ncertificates, which allow them to intercept the communications between the app\n",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "inesmartins.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.7" />
    <link rel="alternate" type="application/rss+xml" title="Inês Martins" href="../rss/index.html" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.5.1/umd/portal.min.js" data-ghost="inesmartins.github.io/"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-180659126-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-180659126-1');
</script>
<!-- Styles -->
<style>
    .gh-head-actions,
    .footer-cta {
        display: none;
    }
    .article-image img {
        max-height: 400px;
        object-fit: contain;
    }
</style><style>:root {--ghost-accent-color: #000000;}</style>

</head>
<body class="post-template tag-ssl tag-android">
<div class="viewport">

    <header id="gh-head" class="gh-head has-cover">
        <nav class="gh-head-inner inner gh-container">

            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../index.html">
                        Inês Martins
                </a>
                <a class="gh-burger" role="button">
                    <div class="gh-burger-box">
                        <div class="gh-burger-inner"></div>
                    </div>
                </a>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <div class="gh-social">
                </div>

                    <a class="gh-head-button" href="index.html#/portal/signup">Subscribe</a>
            </div>
        </nav>
    </header>

    <main>
        



<article class="article post tag-ssl tag-android">

    <header class="article-header gh-canvas">

        <section class="article-tag">
            <a href="../tag/ssl/index.html">ssl</a>
        </section>

        <h1 class="article-title">SSL Pinning on Android</h1>


        <div class="article-byline">
            <section class="article-byline-content">
                <ul class="author-list">
                    <li class="author-list-item">
                        <a href="../author/ines/index.html" class="author-avatar">
                            <img class="author-profile-image" src="../content/images/size/w100/2021/07/750px-Black_flag.svg.png" alt="Inês Martins" />
                        </a>
                    </li>
                </ul>
                <div class="article-byline-meta">
                    <h4 class="author-name"><a href="../author/ines/index.html">Inês Martins</a></h4>
                    <div class="byline-meta-content">
                        <time class="byline-meta-date" datetime="2020-06-08">Jun 8, 2020</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 2 min read</span>
                    </div>
                </div>
            </section>
        </div>

        <figure class="article-image">
            <img
                srcset="../content/images/size/w300/2020/06/mitm.png 300w,
                       ../content/images/size/w600/2020/06/mitm.png 600w,
                      ../content/images/size/w1000/2020/06/mitm.png 1000w,
                     ../content/images/size/w2000/2020/06/mitm.png 2000w"
                sizes="(min-width: 1400px) 1400px, 92vw"
                src="../content/images/size/w2000/2020/06/mitm.png"
                alt="SSL Pinning on Android"
            />
        </figure>
    </header>

    <section class="gh-content gh-canvas">
        <p><em>Banner source: <a href="https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1">https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1</a></em></p><p>When an Android application wants to establish a secure connection with a remote host, it checks whether the certificate's "chain of trust" is valid and compatible with the root CAs (Certificate Authorities) that are pre-installed in the device.</p><p>However, there's nothing stopping malicious actors from generating valid certificates, which allow them to intercept the communications between the app and the server - this is known as a <a href="https://owasp.org/www-community/attacks/Man-in-the-middle_attack">Man in the Middle Attack</a>.</p><p>SSL Pinning prevents this from happening by ensuring that the client only communicates using specific and trustworthy certificates.</p><h3 id="what-certificate-should-you-pin">What certificate should you pin</h3><p>It's possible to pin multiple certificates from the certificate chain. The application will establish a connection with the server as long as <strong>at least one of them</strong> is valid. However:</p><ul><li><strong>pinning</strong> <strong>only a "leaf" certificate</strong> means the application will stop working once the certificate expires. This may or may not be an issue, depending on how often the application is updated (certificates are usually valid for 1-2 years);</li><li><strong>pinning backup "leaves" </strong>can be a good option, but the more certificates you configure, the more certificates you need to protect from compromise;</li><li><strong>pinning</strong> <strong>intermediate certificates</strong> means trusting that the intermediate CAs won't generate malicious certificates for the server. However, if all the "leaves" expire, the app will continue to work.</li></ul><p>Also, note that typically renewing a certificate doesn't change its public key. By <strong>pinning the public key</strong> instead of the certificate itself, you can (sometimes) renew it without breaking the application.</p><h3 id="public-key-pinning-using-okhttp">Public Key Pinning using OkHttp</h3><p><a href="https://square.github.io/okhttp/">OkHttp</a> is one of the most commonly used libraries to manage network requests in Android. Parameterising this library to use SSL pining, and more specifically, public key pinning is very simple:</p><ol><li>Build an instance of <a href="https://square.github.io/okhttp/3.x/okhttp/okhttp3/CertificatePinner.html">CertificatePinner</a> that contains all the public keys and corresponding hostnames you want to pin: </li></ol><pre><code class="language-kotlin">val pinner = CertificatePinner
	.Builder()
    .add(CERT_HOSTNAME_1, CERT_PUBLIC_KEY_1)
    .add(CERT_HOSTNAME_2, CERT_PUBLIC_KEY_2)
    .add(CERT_HOSTNAME_N, CERT_PUBLIC_KEY_N)
	.build()</code></pre><p>2. Pass this object as a param of the <a href="https://square.github.io/okhttp/3.x/okhttp/okhttp3/OkHttpClient.Builder.html">OkHttpClient builder</a>:</p><pre><code class="language-kotlin">val okhttpClient = OkHttpClient
	.Builder()
    .certificatePinner(pinner)
    .build()</code></pre><p>That's it. Now your application will only establish secure connections with servers that have at least one of these certificates configured. </p><h3 id="sources"><strong>Sources</strong></h3><ul><li><a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">Certificate and Public Key Pinning</a></li><li><a href="https://medium.com/@appmattus/android-security-ssl-pinning-1db8acb6621e">Android Security: SSL Pinning</a></li><li><a href="https://dzone.com/refcardz/securing-mobile-applications-with-cert-pinning?chapter=1">Securing Mobile Applications With Cert Pinning</a></li><li><a href="https://www.netguru.com/codestories/3-ways-how-to-implement-certificate-pinning-on-android">3 Ways How To Implement Certificate Pinning on Android</a></li><li><a href="https://www.raywenderlich.com/5634-securing-network-data-tutorial-for-android">Securing Network Data Tutorial for Android</a></li></ul>
    </section>


</article>

<section class="footer-cta">
    <div class="inner">
        <h2>Sign up for more like this.</h2>
        <a class="footer-cta-button" href="index.html#/portal">
            <div>Enter your email</div>
            <span>Subscribe</span>
        </a>
    </div>
</section>


<aside class="read-more-wrap">
    <div class="read-more inner">


                    
<article class="post-card post ">

    <a class="post-card-image-link" href="../exploiting-deep-links-in-android-part-2/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2021/08/maxresdefault-1.jpeg 300w,
                   ../content/images/size/w600/2021/08/maxresdefault-1.jpeg 600w,
                  ../content/images/size/w1000/2021/08/maxresdefault-1.jpeg 1000w,
                 ../content/images/size/w2000/2021/08/maxresdefault-1.jpeg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2021/08/maxresdefault-1.jpeg"
            alt="Exploiting Deep Links in Android - Part 2"
            loading="lazy"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../exploiting-deep-links-in-android-part-2/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">Exploiting Deep Links in Android - Part 2</h2>
            </header>
            <section class="post-card-excerpt">
                <p>In this part, we're going to start to answer the question: "What can you do if you can trick a user into clicking a malicious deep link?" Let's go back to the ABC Bank example. ABC Bank has both a web and an Android application, and they use deep links</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/ines/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2021/07/750px-Black_flag.svg.png" alt="Inês Martins" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/ines/index.html">Inês Martins</a></span>
                <span class="post-card-byline-date"><time datetime="2021-08-15">Aug 15, 2021</time> <span class="bull">&bull;</span> 3 min read</span>
            </div>
        </footer>

    </div>

</article>
                    
<article class="post-card post ">

    <a class="post-card-image-link" href="../exploiting-deep-links-in-android-part1/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2021/08/maxresdefault.jpeg 300w,
                   ../content/images/size/w600/2021/08/maxresdefault.jpeg 600w,
                  ../content/images/size/w1000/2021/08/maxresdefault.jpeg 1000w,
                 ../content/images/size/w2000/2021/08/maxresdefault.jpeg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2021/08/maxresdefault.jpeg"
            alt="Exploiting Deep Links in Android - Part 1"
            loading="lazy"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../exploiting-deep-links-in-android-part1/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">Exploiting Deep Links in Android - Part 1</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Deep links are an often overlooked way to exploit Android applications. In this series I hope do a deep dive into their history, common vulnerabilities with real-life examples, possible mitigations, and testing techniques for pentesters and researchers. In this first part, we do a quick overview of the supported deep</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/ines/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2021/07/750px-Black_flag.svg.png" alt="Inês Martins" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/ines/index.html">Inês Martins</a></span>
                <span class="post-card-byline-date"><time datetime="2021-08-13">Aug 13, 2021</time> <span class="bull">&bull;</span> 6 min read</span>
            </div>
        </footer>

    </div>

</article>
                    
<article class="post-card post ">

    <a class="post-card-image-link" href="../running-php-app-on-big-sur-using-apache/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2021/07/screen-shot-2020_-macos-big-sur.png 300w,
                   ../content/images/size/w600/2021/07/screen-shot-2020_-macos-big-sur.png 600w,
                  ../content/images/size/w1000/2021/07/screen-shot-2020_-macos-big-sur.png 1000w,
                 ../content/images/size/w2000/2021/07/screen-shot-2020_-macos-big-sur.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="../content/images/size/w600/2021/07/screen-shot-2020_-macos-big-sur.png"
            alt="Running a PHP application on Big Sur using Apache"
            loading="lazy"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../running-php-app-on-big-sur-using-apache/index.html">
            <header class="post-card-header">
                <h2 class="post-card-title">Running a PHP application on Big Sur using Apache</h2>
            </header>
            <section class="post-card-excerpt">
                <p>If you have a PHP application and want a quick approach for running it on a mac with the latest OS version, then this tutorial might be useful. Testing and launching the Apache serverBig Sur already comes with Apache installed. You can check the current version by running: ~ httpd -v</p>
            </section>
        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/ines/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2021/07/750px-Black_flag.svg.png" alt="Inês Martins" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/ines/index.html">Inês Martins</a></span>
                <span class="post-card-byline-date"><time datetime="2021-07-23">Jul 23, 2021</time> <span class="bull">&bull;</span> 2 min read</span>
            </div>
        </footer>

    </div>

</article>

    </div>
</aside>


    </main>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../index.html">Inês Martins</a> &copy; 2021</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../assets/built/casper.js%3Fv=9f31058e11"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>



</body>
</html>
