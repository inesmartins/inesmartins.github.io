<!DOCTYPE html>
<html ⚡>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <title>Exploiting Deep Links in Android - Part 1</title>

    <link rel="canonical" href="../index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Exploiting Deep Links in Android - Part 1" />
    <meta property="og:description" content="Deep links are an often overlooked way to exploit Android applications. In this series I hope to do a deep dive into their history, common vulnerabilities with real-life examples, possible mitigations, and testing techniques for pentesters and researchers. In this first part, we do a quick overview of the supported" />
    <meta property="og:url" content="inesmartins.github.io/exploiting-deep-links-in-android-part1/" />
    <meta property="og:image" content="inesmartins.github.io/content/images/2021/08/maxresdefault.jpeg" />
    <meta property="article:published_time" content="2021-08-13T18:22:56.000Z" />
    <meta property="article:modified_time" content="2021-08-30T21:13:09.000Z" />
    <meta property="article:tag" content="android" />
    <meta property="article:tag" content="mobile" />
    <meta property="article:tag" content="deep links" />
    <meta property="article:tag" content="link hijacking" />
    <meta property="article:tag" content="phishing" />
    <meta property="article:tag" content="scheme urls" />
    <meta property="article:tag" content="app links" />
    <meta property="article:tag" content="intent urls" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Exploiting Deep Links in Android - Part 1" />
    <meta name="twitter:description" content="Deep links are an often overlooked way to exploit Android applications. In this series I hope to do a deep dive into their history, common vulnerabilities with real-life examples, possible mitigations, and testing techniques for pentesters and researchers. In this first part, we do a quick overview of the supported" />
    <meta name="twitter:url" content="inesmartins.github.io/exploiting-deep-links-in-android-part1/" />
    <meta name="twitter:image" content="inesmartins.github.io/content/images/2021/08/maxresdefault.jpeg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Inês Martins" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="android, mobile, deep links, link hijacking, phishing, scheme urls, app links, intent urls" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="720" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "",
        "url": "inesmartins.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "inesmartins.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Inês Martins",
        "image": {
            "@type": "ImageObject",
            "url": "inesmartins.github.io/content/images/2022/08/1658857349956.jpeg",
            "width": 420,
            "height": 420
        },
        "url": "inesmartins.github.io/author/ines/",
        "sameAs": [
            "https://www.linkedin.com/in/ines-af-martins/"
        ]
    },
    "headline": "Exploiting Deep Links in Android - Part 1",
    "url": "inesmartins.github.io/exploiting-deep-links-in-android-part1/",
    "datePublished": "2021-08-13T18:22:56.000Z",
    "dateModified": "2021-08-30T21:13:09.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "inesmartins.github.io/content/images/2021/08/maxresdefault.jpeg",
        "width": 1280,
        "height": 720
    },
    "keywords": "android, mobile, deep links, link hijacking, phishing, scheme urls, app links, intent urls",
    "description": "Deep links are an often overlooked way to exploit Android applications.\n\nIn this series I hope to do a deep dive into their history, common\nvulnerabilities with real-life examples, possible mitigations, and testing\ntechniques for pentesters and researchers.\n\nIn this first part, we do a quick overview of the supported deep link formats in\nAndroid, and then quickly jump into the first vulnerability: Link Hijacking.\n\n\n--------------------------------------------------------------------------------\n",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "inesmartins.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.7" />
    <link rel="alternate" type="application/rss+xml" title="" href="../../rss/index.html" />

    <style amp-custom>
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    html {
        overflow-x: hidden;
        overflow-y: scroll;
        font-size: 62.5%;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    body {
        min-height: 100vh;
        margin: 0;
        padding: 0;
        color: #3a4145;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        font-size: 1.7rem;
        line-height: 1.55em;
        font-weight: 400;
        font-style: normal;
        background: #fff;
        scroll-behavior: smooth;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    p,
    ul,
    ol,
    li,
    dl,
    dd,
    hr,
    pre,
    form,
    table,
    video,
    figure,
    figcaption,
    blockquote {
        margin: 0;
        padding: 0;
    }

    ul[class],
    ol[class] {
        padding: 0;
        list-style: none;
    }

    img {
        display: block;
        max-width: 100%;
    }

    input,
    button,
    select,
    textarea {
        font: inherit;
        -webkit-appearance: none;
    }

    fieldset {
        margin: 0;
        padding: 0;
        border: 0;
    }

    label {
        display: block;
        font-size: 0.9em;
        font-weight: 700;
    }

    hr {
        position: relative;
        display: block;
        width: 100%;
        height: 1px;
        border: 0;
        border-top: 1px solid currentcolor;
        opacity: 0.1;
    }

    ::selection {
        text-shadow: none;
        background: #cbeafb;
    }

    mark {
        background-color: #fdffb6;
    }

    small {
        font-size: 80%;
    }

    sub,
    sup {
        position: relative;
        font-size: 75%;
        line-height: 0;
        vertical-align: baseline;
    }
    sup {
        top: -0.5em;
    }
    sub {
        bottom: -0.25em;
    }

    ul li + li {
        margin-top: 0.6em;
    }

    a {
        color: var(--ghost-accent-color, #1292EE);
        text-decoration-skip-ink: auto;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 0;
        font-weight: 700;
        color: #121212;
        line-height: 1.4em;
    }

    h1 {
        font-size: 3.4rem;
        line-height: 1.1em;
    }

    h2 {
        font-size: 2.4rem;
        line-height: 1.2em;
    }

    h3 {
        font-size: 1.8rem;
    }

    h4 {
        font-size: 1.7rem;
    }

    h5 {
        font-size: 1.6rem;
    }

    h6 {
        font-size: 1.6rem;
    }

    amp-img {
        height: 100%;
        width: 100%;
        max-width: 100%;
        max-height: 100%;
    }

    amp-img img {
        object-fit: cover;
    }

    .page-header {
        padding: 50px 5vmin 30px;
        text-align: center;
        font-size: 2rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .page-header a {
        color: #121212;
        font-weight: 700;
        text-decoration: none;
        font-size: 1.6rem;
        letter-spacing: -0.1px;
    }

    .post {
        max-width: 680px;
        margin: 0 auto;
    }

    .post-header {
        margin: 0 5vmin 5vmin;
        text-align: center;
    }

    .post-meta {
        margin: 1rem 0 0 0;
        text-transform: uppercase;
        color: #738a94;
        font-weight: 500;
        font-size: 1.3rem;
    }

    .post-image {
        margin: 0 0 5vmin;
    }

    .post-image img {
        display: block;
        width: 100%;
        height: auto;
    }

    .post-content {
        padding: 0 5vmin;
    }

    .post-content > * + * {
        margin-top: 1.5em;
    }

    .post-content [id]:not(:first-child) {
        margin: 2em 0 0;
    }

    .post-content > [id] + * {
        margin-top: 1rem;
    }

    .post-content [id] + .kg-card,
    .post-content blockquote + .kg-card {
        margin-top: 40px;
    }

    .post-content > ul,
    .post-content > ol,
    .post-content > dl {
        padding-left: 1.9em;
    }

    .post-content hr {
        margin-top: 40px;
    }

    .post .post-content hr + * {
        margin-top: 40px;
    }

    .post-content amp-img {
        background-color: #f8f8f8;
    }

    .post-content blockquote {
        position: relative;
        font-style: italic;
    }

    .post-content blockquote::before {
        content: "";
        position: absolute;
        left: -1.5em;
        top: 0;
        bottom: 0;
        width: 0.3rem;
        background: var(--ghost-accent-color, #1292EE);
    }

    .post-content :not(.kg-card):not([id]) + .kg-card {
        margin-top: 40px;
    }

    .post-content .kg-card + :not(.kg-card) {
        margin-top: 40px;
    }

    .kg-card figcaption {
        padding: 1.5rem 1.5rem 0;
        text-align: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.4em;
        opacity: 0.6;
    }

    .kg-card figcaption strong {
        color: rgba(0,0,0,0.8);
    }

    .post-content :not(pre) code {
        vertical-align: middle;
        padding: 0.15em 0.4em 0.15em;
        border: #e1eaef 1px solid;
        font-weight: 400;
        font-size: 0.9em;
        line-height: 1em;
        color: #15171a;
        background: #f0f6f9;
        border-radius: 0.25em;
    }

    .post-content > pre {
        overflow: scroll;
        padding: 16px 20px;
        color: #fff;
        background: #1F2428;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0,0,0,.1), 0 0 1px rgba(0,0,0,.4);
    }

    .kg-embed-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .kg-image-card img {
        margin: auto;
    }

    .kg-gallery-card + .kg-gallery-card {
        margin-top: 0.75em;
    }

    .kg-gallery-container {
        position: relative;
    }

    .kg-gallery-row {
        display: flex;
        flex-direction: row;
        justify-content: center;
    }

    .kg-gallery-image {
        width: 100%;
        height: 100%;
    }

    .kg-gallery-row:not(:first-of-type) {
        margin: 0.75em 0 0 0;
    }

    .kg-gallery-image:not(:first-of-type) {
        margin: 0 0 0 0.75em;
    }

    .kg-bookmark-card,
    .kg-bookmark-publisher {
        position: relative;
    }

    .kg-bookmark-container,
    .kg-bookmark-container:hover {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row-reverse;
        color: currentColor;
        background: rgba(255,255,255,0.6);
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;
        text-decoration: none;
        border-radius: 5px;
        box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.4);
        overflow: hidden;
    }

    .kg-bookmark-content {
        flex-basis: 0;
        flex-grow: 999;
        padding: 20px;
        order: 1;
    }

    .kg-bookmark-title {
        font-weight: 600;
        font-size: 1.5rem;
        line-height: 1.3em;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        max-height: 45px;
        margin: 0.5em 0 0 0;
        font-size: 1.4rem;
        line-height: 1.55em;
        overflow: hidden;
        opacity: 0.8;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .kg-bookmark-metadata {
        margin-top: 20px;
    }

    .kg-bookmark-metadata {
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 1.3rem;
        line-height: 1.3em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .kg-bookmark-description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
    }

    .kg-bookmark-metadata amp-img {
        width: 18px;
        height: 18px;
        max-width: 18px;
        max-height: 18px;
        margin-right: 10px;
    }

    .kg-bookmark-thumbnail {
        display: flex;
        flex-basis: 20rem;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .kg-bookmark-thumbnail amp-img {
        max-height: 200px;
    }

    .kg-bookmark-author {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .kg-bookmark-publisher::before {
        content: "•";
        margin: 0 .5em;
    }

    .kg-width-full.kg-card-hascaption {
        display: grid;
        grid-template-columns: inherit;
    }

    .post-content table {
        border-collapse: collapse;
        width: 100%;
    }

    .post-content th {
        padding: 0.5em 0.8em;
        text-align: left;
        font-size: .75em;
        text-transform: uppercase;
    }

    .post-content td {
        padding: 0.4em 0.7em;
    }

    .post-content tbody tr:nth-child(2n + 1) {
        background-color: rgba(0,0,0,0.1);
        padding: 1px;
    }

    .post-content tbody tr:nth-child(2n + 2) td:last-child {
        box-shadow:
            inset 1px 0 rgba(0,0,0,0.1),
            inset -1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:nth-child(2n + 2) td {
        box-shadow: inset 1px 0 rgba(0,0,0,0.1);
    }

    .post-content tbody tr:last-child {
        border-bottom: 1px solid rgba(0,0,0,.1);
    }

    .page-footer {
        padding: 60px 5vmin;
        margin: 60px auto 0;
        text-align: center;
        background-color: #f8f8f8;
    }

    .page-footer h3 {
        margin: 0.5rem 0 0 0;
    }

    .page-footer p {
        max-width: 500px;
        margin: 1rem auto 1.5rem;
        font-size: 1.7rem;
        line-height: 1.5em;
        color: rgba(0,0,0,0.6)
    }

    .powered {
        display: inline-flex;
        align-items: center;
        margin: 30px 0 0;
        padding: 6px 9px 6px 6px;
        border: rgba(0,0,0,0.1) 1px solid;
        font-size: 12px;
        line-height: 12px;
        letter-spacing: -0.2px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
        font-weight: 500;
        color: #222;
        text-decoration: none;
        background: #fff;
        border-radius: 6px;
    }

    .powered svg {
        height: 16px;
        width: 16px;
        margin: 0 6px 0 0;
    }

    @media (max-width: 600px) {
        body {
            font-size: 1.6rem;
        }
        h1 {
            font-size: 3rem;
        }

        h2 {
            font-size: 2.2rem;
        }
    }

    @media (max-width: 400px) {
        h1 {
            font-size: 2.6rem;
            line-height: 1.15em;
        }
        h2 {
            font-size: 2rem;
            line-height: 1.2em;
        }
        h3 {
            font-size: 1.7rem;
        }
    }

    :root {--ghost-accent-color: #000000;}
    </style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="page-header">
        <a href="../../index.html">
                
        </a>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Exploiting Deep Links in Android - Part 1</h1>
                <section class="post-meta">
                    Inês Martins -
                    <time class="post-date" datetime="2021-08-13">13 Aug 2021</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="inesmartins.github.io/content/images/2021/08/maxresdefault.jpeg" width="600" height="340" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>Deep links are an often overlooked way to exploit Android applications.</p><p>In this series I hope to do a deep dive into their history, common vulnerabilities with real-life examples, possible mitigations, and testing techniques for pentesters and researchers.</p><p>In this first part, we do a quick overview of the supported deep link formats in Android, and then quickly jump into the first vulnerability: <strong>Link Hijacking</strong>.</p><hr></hr><h2 id="an-intro-to-deep-links-in-android">An Intro to Deep Links in Android</h2><p>In short, deep links allow users to open specific content inside a mobile application.</p><p>In Android, there are 3 valid deep link formats:</p><ol><li><code>Scheme URLs</code> (aka <code>Custom Scheme URLs</code> or <code>URL Schemes</code>)</li><li><code>App Links</code> (aka <code>Android App Links</code>)</li><li><code>Intent URLs</code> (aka <code>Intent Scheme URLs</code>)</li></ol><p>Note that the first 2 have an iOS equivalent, while the 3rd only exists in Android.</p><h3 id="scheme-urls">Scheme URLs</h3><p>Scheme URLs were introduced with <code>Android 1.0</code> and <code>iOS 2.0</code> and clearly prioritised flexibility rather than security.</p><p>In this first iteration of deep links, <strong>any application can register any scheme, host and path</strong>, e.g.:</p><figure class="kg-card kg-image-card"><amp-img src="https://lh6.googleusercontent.com/GD5GzXCpD1TKrM1hnu1qcvNhs2_yIQn-2nrKrDrH4YRCIas12eCYr3N74GHPHNqtzJAmLOZnwCtB4kfcEEtmCfB9DHq_uNSd35zLO4wXkr6SG-_I_SYC7Ylczusju4M4MXfEbyUJruk" class="kg-image" alt width="309" height="67" layout="responsive"></amp-img></figure><p>This means that there's no mechanism to ensure, for example, that all deep links with the <code>fb://</code> scheme are handled by the Facebook app.</p><p>If a user clicks on a deep link, the OS starts by checking which of the applications installed on the device have registered it:</p><ul><li>if there is <strong>only 1 application</strong>, the OS will automatically open the deep link with that application;</li><li>if there is more than 1 application, the OS will check if any of them <strong>have previously been set as the "preference"</strong> - if so, the OS will open the link with that application;</li><li>if there is more than 1 application and none of them have ever been set as the preference, the OS will prompt the user to choose between the apps.</li></ul><figure class="kg-card kg-image-card"></figure><p>Note that if the user clicks "Always" on this prompt, the chosen application becomes the preference, and the prompt will not be shown again.</p><figure class="kg-card kg-image-card"></figure><p>Since any app can register any scheme, a victim application can become vulnerable to Link Hijacking, which we'll discussed in more detail at the end of this part.</p><h3 id="app-links">App Links</h3><p>App Links were introduced in 2015 with <code>Android 6</code> and <code>iOS 9</code> - note that in iOS they're called <a href="https://developer.apple.com/ios/universal-links/">Universal Links</a>.</p><p>App Links no longer support custom schemes, only <code>HTTP</code> or <code>HTTPS</code>. This makes the links "natively" compatible with any browser:</p><figure class="kg-card kg-image-card"><amp-img src="https://lh6.googleusercontent.com/R3QhI5qKJ94cfy_uvz28KSeLJkzk5jFpQzbDCdkCcgFCVajTgpl8i1RNepFyctgXH9HZlcKM8xkztDYrcS8Q5U_yNWdHgvRGSd9LiVrsFBphl9a0ilWTpqZhcbUDIAXHlZOhYMQPrYQ" class="kg-image" alt width="423" height="67" layout="responsive"></amp-img></figure><p>More important, when it comes to security, App Links introduced a mechanism that (at least in theory) prevents other apps from claiming a link: <a href="https://developer.android.com/training/app-links/verify-site-associations">App Link Association</a>.</p><p><strong>App Link Association</strong></p><p>The idea is pretty simple: to make sure that all <code>https://foo.com</code> deep links are always handled by the <code>foo</code> application, the team at Foo simply needs to add a specific file on the <code>foo.com</code> server that contains the <code>SHA256</code> fingerprint of the <code>foo</code> app's signing certificate - see more details <a href="https://developer.android.com/training/app-links/verify-site-associations">here</a>.</p><p>When the <code>foo</code> application is being installed on the device, its <code>AndroidManifest.xml</code> file should indicate that it wants to register and verify the <code>https://foo.com</code> App Link, and as a result the OS will check the aforementioned file - if everything's OK, no other app will be able to claim this link.</p><figure class="kg-card kg-image-card"><amp-img src="https://lh5.googleusercontent.com/7Pnd9LH0pel0rbFOvQqcQBuekklcA-YYIWEPOEpN_yZVDHB3sPgZVkgTV-rlIk2jHtS0jAz619EPBarBHsEh3LW83kBJ6zuOH9KPqbCbfCZOJ_e3JrngRznwwG_2WU9EzLi3IOUSwCw" class="kg-image" alt width="534" height="222" layout="responsive"></amp-img></figure><p>So, the good people at Foo no longer need to worry about Link Hijacking right? ... Nope.</p><p>First, we should note that iOS and Android have different policies when it comes to handling failed verifications:</p><ul><li>iOS prohibits opening unverified Universal Links;</li><li>Android, however, leaves the decision up to users: if an unverified App Link is clicked, Android prompts users to choose if they want to open the link in the app or the browser.</li></ul><figure class="kg-card kg-image-card"></figure><p>Worse even, according to <a href="https://people.cs.vt.edu/gangwang/deep17.pdf">a 2017 study</a>, most apps that use App Links are not correctly completing the verification process! <br />Some common errors included:</p><ul><li>Not creating the associate file</li><li>Registering the App Link with a protocol that doesn't match the file (<code>HTTP</code> vs <code>HTTPS</code>)</li><li>Having an invalid associate file</li><li>Having an invalid manifest file</li></ul><p>Finally, there is one type of Android app that is particularly vulnerable to link hijacking even when using App Links: <a href="https://developer.android.com/topic/google-play-instant">Instant Apps</a>.</p><p>This article won't go into detail regarding these vulnerabilities, but if you're interested I highly recommend <a href="http://www4.comp.polyu.edu.hk/~csxluo/AppLink.pdf">this paper</a>.</p><h3 id="intent-urls">Intent URLs</h3><p>Finally, let's look at the least used deep link type: Intent URLs. They were introduced in 2013 and have a completely different syntax:</p><p><code>intent://p/#Intent;scheme=foo;package=com.foo;end</code>. </p><p>As you can see, the package name of the target app is explicitly specified, which means the OS doesn't prompt the user for their decision, making them <strong>resistant to the types of link hijacking detailed below</strong>.</p><figure class="kg-card kg-image-card"></figure><hr></hr><h2 id="link-hijacking">Link Hijacking</h2><p>As mentioned before, the fact that any application can register any Scheme URL, along with the improper implementation of App Links can make applications vulnerable to Link Hijacking, also known as "Deep Link Collision".</p><p>But, why is this an issue?</p><h3 id="phishing">Phishing</h3><p>Imagine that a user installs a game application on their Android phone. Whenever the user opens the app they just see the game but, in fact, during installation this application registered a deep link that "belongs" to a banking app - <code>abcbank://</code> - which just so happens to be the user's bank.</p><p>One day this user happens to click on the same deep link registered by the "malicious" game app - this isn't strange since it's a valid deep link used by the actual ABC Bank.</p><p>Since the user doesn't yet have the <code>abcbank</code> application installed on their phone, the OS will automatically open the link with the game app. However, now instead of showing the regular game UI, this malicious app displays a login screen that looks exactly like the login screen for <code>abcbank</code>.</p><p>If the malicious application is able to trick the user into entering their <code>ABC Bank</code> credentials on this login screen, it's game over.</p><figure class="kg-card kg-image-card"></figure><h3 id="capturing-sensitive-data">Capturing Sensitive Data</h3><p>In 2019, it was <a href="https://hackerone.com/reports/855618">reported</a> that the Arrive app (now called <a href="https://play.google.com/store/apps/details?id=com.shopify.arrive&amp;hl=en_US&amp;gl=US">Shop</a>) was vulnerable to Account Takeover due to an unverified App Link:</p><figure class="kg-card kg-image-card kg-width-wide"></figure><p>As shown in this example, whenever deep links are used to communicate sensitive data such as authentication tokens, an attacker can use link hijacking to intercept this data.</p><figure class="kg-card kg-image-card"></figure><h3 id="traffic-hijacking">Traffic Hijacking</h3><p>In their 2017 study, "<a href="https://people.cs.vt.edu/gangwang/deep17.pdf">Measuring the Insecurity of Mobile Deep Links of Android</a>", Liu et al. reviewed 160,000+ applications (retrieved from the Play Store) and found many instances of applications that seemed to be registering custom schemes for popular applications in order to boost traffic to their own app. </p><p>They found, for example, that <code>google.com</code> is registered by 480 apps from 305 non-Google developers and that <code>google.navigation</code> from Google Maps was hijacked by 79 apps from 32 developers.</p><h3 id="competing-apps">Competing Apps</h3><p>In the same study mentioned above, it was found that a lot of applications register their competitors' schemes in order to trick users into using their apps:</p><blockquote>For example, Careem (<code>com.careem.acma</code>) and QatarTaxi (<code>com.qatar.qatartaxi</code>) are two competing taxi booking apps in Dubai. Careem is more popular (5M+ downloads), which uses scheme <code>careem</code> for many functionalities such as booking a ride (from hotel websites) and adding credit card information. <br />QatarTaxi (10K downloads) registers to receive all <code>careem://*</code> deep links.<br />After code analysis, we find all these links redirect users to the QatarTaxi app’s home screen, as an attempt to draw customers.</blockquote><hr></hr><p>Hope you found this useful, on <a href="https://inesmartins.github.io/exploiting-deep-links-in-android-part-2/index.html">the next part</a> we'll try to see what happens when a user clicks on a malicious deep link.</p>

            </section>

        </article>
    </main>
    <footer class="page-footer">
        <h3></h3>
        <p><a href="../../index.html">Read more posts →</a></p>
        <a class="powered" href="https://ghost.org" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156 156"><g fill="none" fill-rule="evenodd"><rect fill="#15212B" width="156" height="156" rx="27"/><g transform="translate(36 36)" fill="#F6F8FA"><path d="M0 71.007A4.004 4.004 0 014 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0130 84H4a4 4 0 01-4-4.007v-8.986zM50 71.007A4.004 4.004 0 0154 67h26a4 4 0 014 4.007v8.986A4.004 4.004 0 0180 84H54a4 4 0 01-4-4.007v-8.986z"/><rect y="34" width="84" height="17" rx="4"/><path d="M0 4.007A4.007 4.007 0 014.007 0h41.986A4.003 4.003 0 0150 4.007v8.986A4.007 4.007 0 0145.993 17H4.007A4.003 4.003 0 010 12.993V4.007z"/><rect x="67" width="17" height="17" rx="4"/></g></g></svg> Published with Ghost</a>
    </footer>
    
</body>
</html>
