<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev</title>
    <link rel="stylesheet" href="/assets/built/screen.css?v=99e99ade17">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,400;0,700;0,800;1,400;1,700&display=swap">

    <script>
        var siteUrl = 'https://inesmartins.github.io/';
    </script>

    <script>
        var localTheme = localStorage.getItem('dawn_theme');
        switch (localTheme) {
            case 'dark':
                document.documentElement.classList.add('theme-dark');
                break;
            case 'light':
                document.documentElement.classList.add('theme-light');
                break;
            default:
                break;
        }
    </script>

    <link rel="canonical" href="https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/amp/" />
    
    <meta property="og:site_name" content="Inês Martins" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev" />
    <meta property="og:description" content="The APK for the original challenge can be downloaded here. The author&#x27;s write-up can be downloaded here. We&#x27;re given an Android Package (xmas_ctfzadas.apk) along with the following instructions: Baby pwn tu-tu-tu-tu! - Get the first two flags ({oposec}XPTO) locally; - For the brave ones, find a way" />
    <meta property="og:url" content="https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/" />
    <meta property="og:image" content="https://inesmartins.github.io//content/images/2020/06/highres_471963990-1-1.jpeg" />
    <meta property="article:published_time" content="2020-06-13T21:33:38.000Z" />
    <meta property="article:modified_time" content="2020-06-14T07:43:31.000Z" />
    <meta property="article:tag" content="android" />
    <meta property="article:tag" content="rev" />
    <meta property="article:tag" content="oposec" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev" />
    <meta name="twitter:description" content="The APK for the original challenge can be downloaded here. The author&#x27;s write-up can be downloaded here. We&#x27;re given an Android Package (xmas_ctfzadas.apk) along with the following instructions: Baby pwn tu-tu-tu-tu! - Get the first two flags ({oposec}XPTO) locally; - For the brave ones, find a way" />
    <meta name="twitter:url" content="https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/" />
    <meta name="twitter:image" content="https://inesmartins.github.io//content/images/2020/06/highres_471963990-1-1.jpeg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Inês Martins" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="android, rev, oposec" />
    <meta property="og:image:width" content="504" />
    <meta property="og:image:height" content="105" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Inês Martins",
        "url": "https://inesmartins.github.io//",
        "logo": {
            "@type": "ImageObject",
            "url": "https://inesmartins.github.io//favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Inês Martins",
        "image": {
            "@type": "ImageObject",
            "url": "https://inesmartins.github.io//content/images/2020/07/0PFUtbOg_400x400.jpg",
            "width": 400,
            "height": 400
        },
        "url": "https://inesmartins.github.io//author/ines/",
        "sameAs": []
    },
    "headline": "ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev",
    "url": "https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/",
    "datePublished": "2020-06-13T21:33:38.000Z",
    "dateModified": "2020-06-14T07:43:31.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://inesmartins.github.io//content/images/2020/06/highres_471963990-1-1.jpeg",
        "width": 504,
        "height": 105
    },
    "keywords": "android, rev, oposec",
    "description": "The APK for the original challenge can be downloaded here\n[http://sefod.eu/ctf/xmas_ctfzadas.apk].\nThe author&#x27;s write-up can be downloaded here\n[https://www.dropbox.com/s/nh5thnkf8igarb9/%5B0x78%5D_0xOPOSEC_CHALLENGE_ANDROID_WEBVIEW_BOF.pdf?dl&#x3D;1]\n.\n\nWe&#x27;re given an Android Package (xmas_ctfzadas.apk) along with the following\ninstructions:\n\nBaby pwn tu-tu-tu-tu!\n- Get the first two flags ({oposec}XPTO) locally;\n- For the brave ones, find a way to get the third flag\n- Yup &quot;This_is_the_flag&quot; is your",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://inesmartins.github.io//"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.3" />
    <link rel="alternate" type="application/rss+xml" title="Inês Martins" href="https://inesmartins.github.io//rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.1.0/umd/portal.min.js" data-ghost="https://inesmartins.github.io//"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
    body {
        background: black;
        color: white;
        font-family: 'IBM Plex Mono', monospace;
    }
    .header-left,
    .main-nav,
	.members-subscribe, 
    .members-login, 
    .share-link,
    .social, 
    .copyright,
    .footer-nav {
    	display: none;
    }
    .feed-title {
    	color: var(--lighter-gray-color); !important;
    }
    .related-feed .feed-title {
        color: var(--darker-gray-color); !important;
    }
    h1, h2, 
    .single-title, 
    .single-footer-title {
        color: white;
    }
    code {
        color: black;
    }
</style><style>:root {--ghost-accent-color: #75ffaa;}</style>
</head>

<body class="post-template tag-android tag-rev tag-oposec">
    <svg width="0" height="0" style="display: none;">
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="arrow-left">
        <path d="M26.667 14.667v2.667h-16L18 24.667l-1.893 1.893L5.547 16l10.56-10.56L18 7.333l-7.333 7.333h16z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="arrow-right">
        <path d="M5.333 14.667v2.667h16L14 24.667l1.893 1.893L26.453 16 15.893 5.44 14 7.333l7.333 7.333h-16z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="brightness-2">
        <path
            d="M13.333 2.667c-2.427 0-4.707.667-6.667 1.8 4 2.307 6.667 6.6 6.667 11.533s-2.667 9.227-6.667 11.533c1.96 1.133 4.24 1.8 6.667 1.8 7.36 0 13.333-5.973 13.333-13.333S20.693 2.667 13.333 2.667z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="chevron-left">
        <path d="M20.547 22.107L14.44 16l6.107-6.12L18.667 8l-8 8 8 8 1.88-1.893z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="chevron-right">
        <path d="M11.453 22.107L17.56 16l-6.107-6.12L13.333 8l8 8-8 8-1.88-1.893z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="circle-half-full">
        <path
            d="M16 2.667c-7.36 0-13.333 5.973-13.333 13.333s5.973 13.333 13.333 13.333c7.36 0 13.333-5.973 13.333-13.333s-5.973-13.333-13.333-13.333zM16 5.333c5.893 0 10.667 4.773 10.667 10.667s-4.773 10.667-10.667 10.667v-21.333z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="dots-horizontal">
        <path
            d="M21.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0zM13.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0zM5.333 16c0-1.473 1.194-2.667 2.667-2.667v0c1.473 0 2.667 1.194 2.667 2.667v0c0 1.473-1.194 2.667-2.667 2.667v0c-1.473 0-2.667-1.194-2.667-2.667v0z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="facebook-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zM24 6.667h-3.333A4.672 4.672 0 0 0 16 11.334v3.333h-2.667v4H16V28h4v-9.333h4v-4h-4V12c0-.733.6-1.333 1.333-1.333H24v-4z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="facebook">
        <path
            d="M22.667 2.667V8H20c-.92 0-1.333 1.08-1.333 2v3.333h4v5.333h-4v10.667h-5.333V18.666h-4v-5.333h4V8a5.332 5.332 0 0 1 5.333-5.333h4z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="linkedin">
        <path
            d="M25.333 4c1.473 0 2.667 1.194 2.667 2.667v0 18.667c0 1.473-1.194 2.667-2.667 2.667v0h-18.667c-1.473 0-2.667-1.194-2.667-2.667v0-18.667c0-1.473 1.194-2.667 2.667-2.667v0h18.667zM24.667 24.667v-7.067c0-2.401-1.946-4.347-4.347-4.347v0c-1.133 0-2.453 0.693-3.093 1.733v-1.48h-3.72v11.16h3.72v-6.573c0-1.027 0.827-1.867 1.853-1.867 1.031 0 1.867 0.836 1.867 1.867v0 6.573h3.72zM9.173 11.413c1.237 0 2.24-1.003 2.24-2.24v0c0-1.24-1-2.253-2.24-2.253-1.244 0-2.253 1.009-2.253 2.253v0c0 1.24 1.013 2.24 2.253 2.24zM11.027 24.667v-11.16h-3.693v11.16h3.693z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" id="loader">
        <path opacity="0.3" fill="currentColor"
            d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
        <path fill="currentColor"
            d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z">
            <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20"
                dur="0.5s" repeatCount="indefinite" />
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="magnify">
        <path
            d="M12.667 4a8.667 8.667 0 0 1 8.667 8.667c0 2.147-.787 4.12-2.08 5.64l.36.36h1.053l6.667 6.667-2 2-6.667-6.667v-1.053l-.36-.36a8.689 8.689 0 0 1-5.64 2.08C7.88 21.334 4 17.454 4 12.667S7.88 4 12.667 4zm0 2.667c-3.333 0-6 2.667-6 6s2.667 6 6 6 6-2.667 6-6-2.667-6-6-6z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="menu-down">
        <path d="M9.333 13.333L16 20l6.667-6.667H9.334z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="rss-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zM10 20c-1.107 0-2 .893-2 2s.893 2 2 2 2-.893 2-2-.893-2-2-2zm-2-6.667V16c4.413 0 8 3.587 8 8h2.667c0-5.893-4.773-10.667-10.667-10.667zM8 8v2.667c7.36 0 13.333 5.973 13.333 13.333H24c0-8.84-7.16-16-16-16z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="star">
        <path
            d="M16 23.027L24.24 28l-2.187-9.373 7.28-6.307-9.587-.827-3.747-8.827-3.747 8.827-9.587.827 7.267 6.307L7.759 28l8.24-4.973z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="table-of-contents">
        <path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="twitter-box">
        <path
            d="M6.667 4h18.667c1.467 0 2.667 1.2 2.667 2.667v18.667c0 1.467-1.2 2.667-2.667 2.667H6.667A2.675 2.675 0 0 1 4 25.334V6.667C4 5.2 5.2 4 6.667 4zm16.946 8.44c.64-.533 1.387-1.173 1.72-1.88-.547.28-1.2.453-1.92.547.667-.48 1.213-1.107 1.493-1.96-.693.373-1.4.693-2.28.853-2.067-2.493-7.013-.467-6.133 3.267-3.48-.213-5.6-1.787-7.36-3.72-1 1.627-.133 4.093 1.053 4.773-.613-.04-1.08-.227-1.52-.44.053 2.053 1.187 3.04 2.773 3.573a4.47 4.47 0 0 1-1.52.04c.493 1.427 1.52 2.32 3.28 2.507-1.2 1.013-3.413 1.72-5.2 1.44 1.533.973 3.28 1.747 5.707 1.64 5.88-.267 9.813-4.48 9.907-10.64z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="twitter">
        <path
            d="M29.947 8a11.423 11.423 0 0 1-3.28.92 5.738 5.738 0 0 0 2.507-3.173 11.52 11.52 0 0 1-3.627 1.4C24.494 6 23.014 5.334 21.334 5.334c-3.133 0-5.693 2.56-5.693 5.72 0 .453.053.893.147 1.307A16.261 16.261 0 0 1 4.001 6.388a5.663 5.663 0 0 0-.773 2.867c0 1.987 1 3.747 2.547 4.747-.947 0-1.827-.267-2.6-.667v.04a5.724 5.724 0 0 0 4.587 5.613 5.644 5.644 0 0 1-2.574.093c.72 2.253 2.813 3.933 5.333 3.973-1.947 1.547-4.413 2.453-7.107 2.453-.453 0-.907-.027-1.36-.08A16.19 16.19 0 0 0 10.827 28c10.507 0 16.28-8.72 16.28-16.28 0-.253 0-.493-.013-.747A11.42 11.42 0 0 0 29.947 8z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="white-balance-sunny">
        <path
            d="M4.733 24.72l1.88 1.88 2.4-2.387L7.12 22.32zm9.934 5.213h2.667V26h-2.667zM16 7.333c-4.413 0-8 3.587-8 8s3.587 8 8 8 8-3.587 8-8c0-4.427-3.587-8-8-8zm10.667 9.334h4V14h-4zm-3.68 7.546l2.4 2.387 1.88-1.88-2.387-2.4zm4.28-18.266l-1.88-1.88-2.4 2.387 1.893 1.893zM17.333.733h-2.667v3.933h2.667zM5.333 14h-4v2.667h4zm3.68-7.547l-2.4-2.387-1.88 1.88 2.387 2.4 1.893-1.893z">
        </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="window-close">
        <path
            d="M17.947 16l7.387 7.387v1.947h-1.947L16 17.947l-7.387 7.387H6.666v-1.947L14.053 16 6.666 8.613V6.666h1.947L16 14.053l7.387-7.387h1.947v1.947L17.947 16z">
        </path>
    </symbol>
</svg>
    <div class="site">
        <header class="site-header container">
    <div class="header-left">
        <a class="logo" href="https://inesmartins.github.io/">
                <span class="logo-text">Inês Martins</span>
        </a>
    </div>
        <nav class="main-nav hidden-xs hidden-sm hidden-md">
                <a class="menu-item menu-item-home"
        href="https://inesmartins.github.io//">Home</a>

            <button class="button-icon menu-item-button js-modal" data-modal="search" aria-label="Search">
                <svg class="icon">
                    <use xlink:href="#magnify"></use>
                </svg>
            </button>
        </nav>

        <button class="button-icon hidden-lg hidden-xl js-modal" data-modal="search" aria-label="Search">
            <svg class="icon">
                <use xlink:href="#magnify"></use>
            </svg>
        </button>
        <div class="burger hidden-lg hidden-xl">
            <div class="burger-bar"></div>
            <div class="burger-bar"></div>
        </div>

        <div class="mobile-menu hidden-lg hidden-xl">
            <div class="container">
                <nav class="mobile-nav">
                        <a class="menu-item menu-item-home"
        href="https://inesmartins.github.io//">Home</a>

                        <button class="button-text menu-item members-login" data-portal="signin">Login</button>
                        <button class="button-text menu-item menu-item-cta members-subscribe" data-portal="signup">Subscribe</button>
                </nav>
            </div>
        </div>
    <div class="header-right hidden-xs hidden-sm hidden-md">
            <button class="button-text menu-item members-login" data-portal="signin">Login</button>
            <button class="button-text menu-item menu-item-cta members-subscribe" data-portal="signup">Subscribe</button>
    </div>
</header>

        <header class="sticky">
            <div class="sticky-title">ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev</div>
            <button class="button-icon sticky-toc-button" aria-label="Table of Contents">
                <svg class="icon">
                    <use xlink:href="#table-of-contents"></use>
                </svg>
                <div class="sticky-toc"></div>
            </button>
            <div class="sticky-track">
                <div class="sticky-progress"></div>
            </div>
        </header>
        <div class="site-content">
            
<div class="content-area">
    <main class="site-main">
            <article class="single post tag-android tag-rev tag-oposec">
    <header class="single-header kg-canvas">
            <div class="single-meta">
                <span class="single-meta-item single-meta-date">
                    <time datetime="2020-06-13">
                        Jun 13, 2020
                    </time>
                </span>
                <span class="single-meta-item single-meta-length">
                    5 min read
                </span>
                    <span class="single-meta-item single-meta-tag">
                        <a class="post-tag post-tag-android" href="/tag/android/">
                            android
                        </a>
                    </span>
            </div>
        <h1 class="single-title">ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev</h1>
                <div class="single-media kg-width-wide u-placeholder horizontal">
                    <img class="lazyload u-object-fit" data-srcset="/content/images/size/w400/2020/06/highres_471963990-1-1.jpeg 400w,
/content/images/size/w750/2020/06/highres_471963990-1-1.jpeg 750w,
/content/images/size/w960/2020/06/highres_471963990-1-1.jpeg 960w,
/content/images/size/w1140/2020/06/highres_471963990-1-1.jpeg 1140w"
                        data-sizes="auto" src="/content/images/size/w960/2020/06/highres_471963990-1-1.jpeg"
                        srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                        alt="ØxOPOSɆC Baby Xmas Challenge 2019 | Android Rev">
                </div>
    </header>
    <div class="single-content kg-canvas u-text-format">
        <p><em>The APK for the original challenge can be downloaded <a href="http://sefod.eu/ctf/xmas_ctfzadas.apk">here</a>.</em><br><em>The author's write-up can be downloaded <a href="https://www.dropbox.com/s/nh5thnkf8igarb9/%5B0x78%5D_0xOPOSEC_CHALLENGE_ANDROID_WEBVIEW_BOF.pdf?dl=1">here</a>.</em></p><p>We're given an Android Package (<code>xmas_ctfzadas.apk</code>) along with the following instructions:</p><!--kg-card-begin: markdown--><pre><code>Baby pwn tu-tu-tu-tu!
- Get the first two flags ({oposec}XPTO) locally;
- For the brave ones, find a way to get the third flag
- Yup &quot;This_is_the_flag&quot; is your friend but not the final solution.
</code></pre>
<!--kg-card-end: markdown--><h2 id="unzipping-the-apk">Unzipping the APK</h2><p>An APK is actually just a ZIP file, by unzipping it we get to see the compressed files:</p><!--kg-card-begin: markdown--><pre><code>~ unzip app.apk

~ ls -la
...
-rw-r--r--@  1 inesmartins  staff     2444 Nov 22  2019 AndroidManifest.xml
drwxr-xr-x@  5 inesmartins  staff      160 Jun 13 20:59 META-INF
-rw-r--r--@  1 inesmartins  staff   178784 Nov 22  2019 classes.dex
-rw-r--r--@  1 inesmartins  staff  2062612 Nov 22  2019 classes2.dex
drwxr-xr-x@  3 inesmartins  staff       96 Jun 13 20:59 lib
drwxr-xr-x@ 16 inesmartins  staff      512 Jun 13 20:59 res
-rw-r--r--@  1 inesmartins  staff   225072 Nov 22  2019 resources.arsc
</code></pre>
<!--kg-card-end: markdown--><p>So, as expected we see <code>AndroidManifest.xml</code>, some .dex files (the source code), the resources, and also one <a href="https://en.wikipedia.org/wiki/Java_Native_Interface">Java Native Interface</a> (JNI) library that contains some interesting information:</p><!--kg-card-begin: markdown--><pre><code>~ strings lib/armeabi-v7a/libopoctf-jni.so

...
Java_pt_oposec_ctfzadas_CTFObject_firstFlag
Java_pt_oposec_ctfzadas_CTFObject_secondFlag
Java_pt_oposec_ctfzadas_CTFObject_thirdFlag
Java_pt_oposec_ctfzadas_MainActivity_stringFromJNI
envzadas
jump_here
jump_not_here
...
tres_out
...
This_is_not_the_flag
This_is_the_flag
...
</code></pre>
<!--kg-card-end: markdown--><h2 id="decoding-the-app">Decoding the app</h2><p><a href="https://ibotpeaches.github.io/Apktool/">apktool</a> is able to rebuild some of the resources of the Android project back to their original format, which is very useful when trying to read the <code>AndroidManifest.xml</code> file:</p><!--kg-card-begin: markdown--><pre><code>~ apktool decode xmas_ctfzadas.apk

~ cat xmas_ctfzadas/AndroidManifest.xml

&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
          android:compileSdkVersion=&quot;23&quot;
          android:compileSdkVersionCodename=&quot;6.0-2438415&quot;
          package=&quot;pt.oposec.ctfzadas&quot;
          platformBuildVersionCode=&quot;1&quot;
          platformBuildVersionName=&quot;1.0&quot;&gt;
    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;/&gt;
    &lt;application android:appComponentFactory=&quot;android.support.v4.app.CoreComponentFactory&quot;
                 android:allowBackup=&quot;true&quot;
                 android:debuggable=&quot;true&quot;
                 android:exported=&quot;true&quot;
                 android:icon=&quot;@mipmap/ic_launcher&quot;
                 android:label=&quot;@string/app_name&quot;
                 android:supportsRtl=&quot;true&quot;
                 android:theme=&quot;@style/AppTheme&quot;&gt;
        &lt;activity android:name=&quot;pt.oposec.ctfzadas.MainActivity&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.MAIN&quot;/&gt;
                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot;/&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>
<!--kg-card-end: markdown--><p>As you can see, this application has only one <a href="https://developer.android.com/reference/android/app/Activity">Activity</a> - MainActivity.</p><h2 id="static-analysis-with-jd-gui">Static analysis with JD-GUI</h2><p>We start by transforming the .dex files into a single .jar file using the <a href="https://sourceforge.net/projects/dex2jar/files/">dex2jar</a> script:</p><!--kg-card-begin: markdown--><pre><code>~ sh dex2jar-2.0/d2j-dex2jar.sh -f xmas_ctfzadas.apk
</code></pre>
<!--kg-card-end: markdown--><p>To go through the .jar we use <a href="http://java-decompiler.github.io/">JD-GUI</a>.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io//content/images/2020/06/files-1.png" class="kg-image" alt loading="lazy"></figure><p>The <code>pt.oposec.ctfzadas</code> package contains 4 classes:</p><ul><li><code>BuildConfig.class</code> and <code>R.class</code> are both automatically generated files: the first lists the project configs and the second identifies all the project assets;</li><li>this leaves only 2 interesting files: <code>MainActivity.class</code> and <code>CTFObject.class</code>.</li></ul><h3 id="mainactivity-class">MainActivity.class</h3><p>As we can see below, on app start the MainActivity loads the <code>opoctf-jni</code> library, then creates a <a href="https://developer.android.com/reference/android/webkit/WebView">Webview</a> that has access to an instance of the <code>CTFObject</code> class called <code>ctfObj</code>. The webview's URL depends on the Intent's <code>open_sesame</code> query string.</p><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io//content/images/2020/06/main-2.png" class="kg-image" alt loading="lazy"></figure><h3 id="ctfobject-class">CTFObject.class</h3><p>This class is quite interesting:</p><ol><li>There is a function called <code>um</code> that returns the output of the <code>firstFlag</code> JNI function:</li></ol><pre><code class="language-java">public class CTFObject {
...
	
    public native String firstFlag();
    
    @JavascriptInterface
    public String um() {
        return firstFlag();
    }

...
}
</code></pre><p>2. Similarly, there's a function called <code>dois</code> that calls the <code>secondFlag</code> JNI function with a string param. Note that there's a 5-number PIN mentioned on this function.</p><pre><code class="language-java">public class CTFObject {
...

    public native String secondFlag(String paramString);

    @JavascriptInterface
    public String dois(String paramString) {
        Log.d("OPOSEC", "Pin have 5 numbers (String)\nString starts with \"{oposec}\"");
        Log.d(secondFlag(paramString), secondFlag(paramString));
        return secondFlag(paramString);
    }

...
}
</code></pre><p>3. Finally, there's a <code>tres</code> function that calls the <code>thirdFlag</code> function from the JNI library with a byte array that's parsed from a hex string:</p><pre><code class="language-java">public class CTFObject {
...

    public static byte[] hexStringToByteArray(String paramString) {
        int j = paramString.length();
        byte[] arrayOfByte = new byte[j / 2 + 1];
        for (int i = 0; i &lt; j; i += 2)
            arrayOfByte[i / 2] = (byte)((Character.digit(paramString.charAt(i), 16) &lt;&lt; 4) + Character.digit(paramString.charAt(i + 1), 16));
            arrayOfByte[arrayOfByte.length - 1] = Integer.valueOf(0).byteValue();
        return arrayOfByte;
    }
  
    public native String thirdFlag(byte[] paramArrayOfbyte);
    
    @JavascriptInterface
    public String tres(String paramString) {
        Log.d("aaa-", paramString);
        byte[] arrayOfByte = hexStringToByteArray(paramString);
        Log.d("aaa:", String.valueOf(arrayOfByte));
        return thirdFlag(arrayOfByte);
    }

...
}
</code></pre><p>Note that functions <code>um</code>, <code>dois</code> and <code>tres</code> are accessible on the MainActivity's webview since they're marked with the <a href="https://developer.android.com/reference/android/webkit/JavascriptInterface">JavascriptInterface notation</a>.</p><h2 id="re-creating-the-android-project">Re-Creating the Android project</h2><p>After installing <a href="https://developer.android.com/studio/?gclid=CjwKCAjw8pH3BRAXEiwA1pvMsX1EY3uC8enHJFsoQM2iuA4gUypWFvBJ7tUuhjy1dcuRjtUnVzUa3RoCvdcQAvD_BwE&amp;gclsrc=aw.ds">Android Studio</a> we create a new Android project and then:</p><ul><li>add the <code>CTFObject</code> class to <code>src/main/java/pt.oposec.ctfzadas</code> - I ended up changing the Java code to Kotlin, since I'm more familiar with it.</li><li>add the <code>libopoctf-jni.so</code> library under <code>/src/main/jniLibs/armeabi-v7a</code> (this path is extremely important).</li></ul><figure class="kg-card kg-image-card"><img src="https://inesmartins.github.io//content/images/2020/06/dir.png" class="kg-image" alt loading="lazy"></figure><h2 id="getting-the-first-flag">Getting the first flag</h2><p>The first flag is very simple, all we need is an instance of <code>CTFObject</code> and then we can simply print the result of calling either <code>um</code> or the <code>firstFlag</code> function directly, as shown below.</p><pre><code class="language-kotlin">package pt.oposec.ctfzadas

import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity

class MainActivity : AppCompatActivity() {

    private var ctfObject = CTFObject()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        print(ctfObject.firstFlag())
    }
}
</code></pre><h2 id="getting-the-second-flag">Getting the second flag</h2><p>From the <code>CTFObject</code> class we know we need to find a 5-digit PIN code, which we can easily brute force. Knowing that the flag has the word <code>oposec</code> we simply run through all the options until we get the one that prints out the flag:</p><pre><code class="language-kotlin">package pt.oposec.ctfzadas

import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity

class MainActivity : AppCompatActivity() {
    
    private var ctfObject = CTFObject()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        for (i in 0..9) {
            for (j in 0..9) {
                for (k in 0..9) {
                    for (l in 0..9) {
                        for (m in 0..9) {
                            val pin = "$i$j$k$l$m"
                            val res = ctfObject.secondFlag(pin)
                            if (res.contains("oposec")) {
                                print("Pin is: " + pin)
                                print("Flag is: " + res)
                            }
                        }
                    }
                }
            }
        }
        print("Could not get flag")   
    }
    ```</code></pre><h2 id="useful-resources">Useful Resources</h2><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://stackoverflow.com/questions/24357687/how-to-include-so-library-in-android-studio"><div class="kg-bookmark-content"><div class="kg-bookmark-title">How to include *.so library in Android Studio?</div><div class="kg-bookmark-description">I read many threads how to add a *.so library to Android Studio, but none of them works, especially when it comes to the point of text: This does not work with the newer xxx (Android Studio, gradle...</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon.png?v&#x3D;c78bd457575a"><span class="kg-bookmark-author">Stack Overflow</span><span class="kg-bookmark-publisher">Ronald Wiplinger</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v&#x3D;73d79a89bded"></div></a></figure>
    </div>
        <footer class="single-footer container medium">
            <div class="single-footer-left">
                    <div class="navigation navigation-previous">
                        <a class="navigation-link" href="/simplest-way-to-host-your-ghost-site-on-gitpages/"
                            aria-label="Previous post">
                            <svg class="icon navigation-icon">
                                <use xlink:href="#arrow-left"></use>
                            </svg>
                        </a>
                    </div>
            </div>
            <div class="single-footer-middle">
                <div class="single-footer-top">
                    <h3 class="single-footer-title">Published by:</h3>
                    <div class="author-list">
                            <div
                                class="author-image-placeholder u-placeholder square">
                                <a href="/author/ines/" title="Inês Martins">
                                    <img class="author-image lazyload u-object-fit"
                                        data-srcset="/content/images/size/w150/2020/07/0PFUtbOg_400x400.jpg"
                                        src="/content/images/size/w150/2020/07/0PFUtbOg_400x400.jpg"
                                        srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                                        alt="Inês Martins">
                                </a>
                            </div>
                    </div>
                </div>
                <div class="single-footer-bottom">
                    <div class="share">
                        <a class="share-link share-link-facebook"
                            href="https://www.facebook.com/sharer.php?u=https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/"
                            target="_blank" rel="noopener noreferrer">
                            <svg class="icon icon-facebook">
                                <use xlink:href="#facebook"></use>
                            </svg>
                            Share
                        </a>
                        <a class="share-link share-link-twitter"
                            href="https://twitter.com/intent/tweet?url=https://inesmartins.github.io//oposec-baby-xmas-challenge-android-rev/&text=%C3%98xOPOS%C9%86C%20Baby%20Xmas%20Challenge%202019%20%7C%20Android%20Rev"
                            target="_blank" rel="noopener noreferrer">
                            <svg class="icon icon-twitter">
                                <use xlink:href="#twitter"></use>
                            </svg>
                            Tweet
                        </a>
                    </div>
                </div>
            </div>
            <div class="single-footer-right">
                    <div class="navigation navigation-next">
                        <a class="navigation-link" href="/how-to-hash-and-store-a-password/"
                            aria-label="Next post">
                            <svg class="icon navigation-icon">
                                <use xlink:href="#arrow-right"></use>
                            </svg>
                        </a>
                    </div>
            </div>
        </footer>
</article>                    <section class="related-wrapper">
            <div class="container medium">
                <h3 class="related-title">You might also like...</h3>
                <div class="related-feed">
                        <article class="feed post">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Mar
        </div>
        <div class="feed-calendar-day">
            24
        </div>
    </div>
    <h2 class="feed-title">ØxOPOSɆC - Secrets [Crypto]</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            3 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/oposec-secrets/" aria-label="ØxOPOSɆC - Secrets [Crypto]"></a>
</article>                        <article class="feed post">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Feb
        </div>
        <div class="feed-calendar-day">
            23
        </div>
    </div>
    <h2 class="feed-title">ØxOPOSɆC | Neuromancer</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            3 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/oposec-neuromancer/" aria-label="ØxOPOSɆC | Neuromancer"></a>
</article>                        <article class="feed post">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Dec
        </div>
        <div class="feed-calendar-day">
            09
        </div>
    </div>
    <h2 class="feed-title">ØxOPOSɆC | Underground Leaks (Crypto) - Part II</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            1 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/oposec-underground-leaks-part-ii/" aria-label="ØxOPOSɆC | Underground Leaks (Crypto) - Part II"></a>
</article>                        <article class="feed post">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Oct
        </div>
        <div class="feed-calendar-day">
            27
        </div>
    </div>
    <h2 class="feed-title">ØxOPOSɆC | Underground Leaks (Crypto)</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            5 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/oposec-underground-leaks/" aria-label="ØxOPOSɆC | Underground Leaks (Crypto)"></a>
</article>                        <article class="feed post">
    <div class="feed-calendar">
        <div class="feed-calendar-month">
            Sep
        </div>
        <div class="feed-calendar-day">
            25
        </div>
    </div>
    <h2 class="feed-title">ØxOPOSɆC Summer Challenge 2020 | Misc Challenges Write-up</h2>
    <div class="feed-right">
        <svg class="icon feed-visibility feed-visibility-public">
            <use xlink:href="#star"></use>
        </svg>
        <div class="feed-length">
            3 min read
        </div>
    </div>
    <svg class="icon feed-icon">
        <use xlink:href="#chevron-right"></use>
    </svg>
    <a class="u-permalink" href="/oposec-summer-challenge-2020/" aria-label="ØxOPOSɆC Summer Challenge 2020 | Misc Challenges Write-up"></a>
</article>                </div>
            </div>
        </section>
                </main>
</div>
        </div>
        <footer class="site-footer container">
    <div class="social">
        <a class="social-item social-item-rss"
            href="https://feedly.com/i/subscription/feed/https://inesmartins.github.io//rss/"
            target="_blank" rel="noopener noreferrer" aria-label="RSS">
            <svg class="icon">
                <use xlink:href="#rss-box"></use>
            </svg>
        </a>
    </div>

    <div class="copyright">
        Powered by <a href="https://ghost.org/" target="_blank"
            rel="noopener noreferrer">Ghost</a>
    </div>

    <nav class="footer-nav">
        
        <a class="menu-item js-theme" href="#" data-system="System theme" data-dark="Dark theme" data-light="Light theme">
            <svg class="icon theme-icon theme-icon-system">
                <use xlink:href="#circle-half-full"></use>
            </svg>
            <svg class="icon theme-icon theme-icon-dark">
                <use xlink:href="#brightness-2"></use>
            </svg>
            <svg class="icon theme-icon theme-icon-light">
                <use xlink:href="#white-balance-sunny"></use>
            </svg>
            <span class="theme-text">System theme</span>
        </a>
    </nav>
</footer>        <div class="modal-overlay">
    <div class="modal modal-search">
        <div class="form-wrapper">
            <input class="modal-input search-input" type="search" placeholder="Enter keyword...">
            <button class="form-button search-button" aria-label="Search">
                <svg class="icon icon-search">
                    <use xlink:href="#magnify"></use>
                </svg>
                <svg class="icon icon-close">
                    <use xlink:href="#window-close"></use>
                </svg>
            </button>
        </div>
                <div class="popular-wrapper">
                    <h4 class="popular-title">Popular tags</h4>
                    <div class="popular-feed">
                            <a class="popular" href="/tag/oposec/">oposec</a>
                            <a class="popular" href="/tag/htb/">htb</a>
                            <a class="popular" href="/tag/ctf/">ctf</a>
                            <a class="popular" href="/tag/cryptography/">cryptography</a>
                            <a class="popular" href="/tag/crypto/">crypto</a>
                    </div>
                </div>
        <div class="search-result"></div>
    </div>
    <button class="button-icon modal-close" aria-label="Close">
        <svg class="icon icon-close">
            <use xlink:href="#window-close"></use>
        </svg>
    </button>
</div>        <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe.
        It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides.
          PhotoSwipe keeps only 3 of them in the DOM to save memory.
          Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>    </div>

    <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous">
    </script>
    <script src="/assets/built/main.min.js?v=99e99ade17"></script>

    
</body>

</html>